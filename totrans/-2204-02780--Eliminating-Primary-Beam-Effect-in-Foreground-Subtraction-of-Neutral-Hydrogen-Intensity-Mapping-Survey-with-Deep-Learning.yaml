- en: <!--yml
  prefs: []
  type: TYPE_NORMAL
- en: 'category: 未分类'
  prefs: []
  type: TYPE_NORMAL
- en: 'date: 2024-09-06 19:47:19'
  prefs: []
  type: TYPE_NORMAL
- en: -->
  prefs: []
  type: TYPE_NORMAL
- en: '[2204.02780] Eliminating Primary Beam Effect in Foreground Subtraction of Neutral
    Hydrogen Intensity Mapping Survey with Deep Learning'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 来源：[https://ar5iv.labs.arxiv.org/html/2204.02780](https://ar5iv.labs.arxiv.org/html/2204.02780)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Eliminating Primary Beam Effect in Foreground Subtraction of Neutral Hydrogen
    Intensity Mapping Survey with Deep Learning
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[Shulei Ni](https://orcid.org/0000-0002-5386-1627) Department of Physics, College
    of Sciences, Northeastern University, Shenyang 110819, China [Yichao Li](https://orcid.org/0000-0003-1962-2013)
    Department of Physics, College of Sciences, Northeastern University, Shenyang
    110819, China [Li-Yang Gao](https://orcid.org/0000-0001-5469-5408) Department
    of Physics, College of Sciences, Northeastern University, Shenyang 110819, China
    [Xin Zhang](https://orcid.org/0000-0002-6029-1933) Department of Physics, College
    of Sciences, Northeastern University, Shenyang 110819, China Frontiers Science
    Center for Industrial Intelligence and Systems Optimizaiton, Northeastern University,
    Shenyang 110819, China Key Laboratory of Data Analytics and Optimization for Smart
    Industry (Ministry of Education), Northeastern University, China Xin Zhang [zhangxin@mail.neu.edu.cn](mailto:zhangxin@mail.neu.edu.cn)'
  prefs: []
  type: TYPE_NORMAL
- en: Abstract
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: In the neutral hydrogen (HI) intensity mapping (IM) survey, the foreground contamination
    on the cosmological signals is extremely severe, and the systematic effects caused
    by radio telescopes themselves further aggravate the difficulties in subtracting
    foreground. In this work, we investigate whether the deep learning method, concretely
    the 3D U-Net algorithm here, can play a crucial role in foreground subtraction
    when considering the systematic effect caused by the telescope’s primary beam.
    We consider two beam models, i.e., the Gaussian beam model as a simple case and
    the Cosine beam model as a sophisticated case. The traditional principal component
    analysis (PCA) method is employed as a comparison and, more importantly, as the
    preprocessing step for the U-Net method to reduce the sky map dynamic range. We
    find that in the case of the Gaussian beam, the PCA method can effectively clean
    the foreground. However, the PCA method cannot handle the systematic effect induced
    by the Cosine beam, and the additional U-Net method can improve the result significantly.
    In order to show how well the PCA and U-Net methods can recover the HI signals,
    we also derive the HI angular power spectra, as well as the HI 2D power spectra,
    after performing the foreground subtractions. It is found that, in the case of
    Gaussian beam, the concordance with the original HI map using U-Net is better
    than that using PCA by $27.4\%$, and in the case of Cosine beam, the concordance
    using U-Net is better than that using PCA by $144.8\%$. Therefore, the U-Net based
    foreground subtraction can efficiently eliminate the telescope primary beam effect
    and shed new light on recovering the HI power spectrum for future HI IM experiments.
  prefs: []
  type: TYPE_NORMAL
- en: 1 Introduction
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The cosmic large-scale structure (LSS) carries crucial information about the
    evolutionary history of the Universe. The neutral hydrogen (HI) intensity mapping
    (IM) has been proposed as a promising technique for the LSS survey (e.g. Battye
    et al., [2004](#bib.bib12); McQuinn et al., [2006](#bib.bib35); Pritchard & Loeb,
    [2008](#bib.bib41)). HI IM relies on observing integrated HI 21-cm emission of
    many galaxies in large voxels and can be quickly carried out to cover a very large
    survey volume, which is ideal for cosmological studies (Chang et al., [2008](#bib.bib16);
    Loeb & Wyithe, [2008](#bib.bib30); Mao et al., [2008](#bib.bib32); Wyithe & Loeb,
    [2008](#bib.bib58); Wyithe et al., [2008](#bib.bib59); Bagla et al., [2010](#bib.bib9);
    Seo et al., [2010](#bib.bib47); Lidz et al., [2011](#bib.bib28); Ansari et al.,
    [2012](#bib.bib6); Battye et al., [2013](#bib.bib11)).
  prefs: []
  type: TYPE_NORMAL
- en: Chang et al. ([2010](#bib.bib15)) for the first time explored the HI IM technique
    with Green Bank Telescope (GBT) by measuring the cross-correlation function between
    an HI IM survey and an optical galaxy survey. So far, several other explorations
    of HI IM have been done by measuring the cross-correlation power spectrum between
    the HI IM survey and the optical galaxy survey, e.g., using the GBT or Parkes
    telescope (Masui et al., [2013](#bib.bib33); Anderson et al., [2018](#bib.bib5);
    Wolz et al., [2017](#bib.bib54), [2022](#bib.bib55)), but the HI IM auto-correlation
    power spectrum remains undetected (Switzer et al., [2013](#bib.bib51)). Besides,
    a number of specially designed radio telescopes or telescope arrays targeting
    at HI IM LSS survey, such as Tianlai (Chen, [2012](#bib.bib17)), CHIME (Bandura
    et al., [2014](#bib.bib10)), BINGO (Peel et al., [2019](#bib.bib40)), FAST (Nan
    et al., [2011](#bib.bib37)), HIRAX (Newburgh et al., [2016](#bib.bib38)), are
    either under construction or collecting data (Wu et al., [2021](#bib.bib56); Li
    et al., [2020](#bib.bib26); Wuensche et al., [2021](#bib.bib57); Abdalla et al.,
    [2021](#bib.bib1); Amiri et al., [2022](#bib.bib4)). The HI IM is proposed as
    the major technique for cosmological exploration with the Square Kilometre Array
    (SKA) (Santos et al., [2015](#bib.bib45); Bull et al., [2015](#bib.bib14); Bacon
    et al., [2020](#bib.bib8)). Moreover, with the newly built MeerKAT array, it is
    also proposed to have an HI IM survey in single-dish mode (Santos et al., [2017](#bib.bib46);
    Li et al., [2021](#bib.bib27); Wang et al., [2021](#bib.bib53)).
  prefs: []
  type: TYPE_NORMAL
- en: However, there are a couple of technical challenges for HI IM data analysis.
    The major challenge comes from extracting the weak HI brightness fluctuation from
    bright foreground radio emission in the same frequency range, i.e., the synchrotron
    or free-free emission of the Galaxy and nearby radio galaxy point sources. It
    is shown that the intensity of foreground emission, especially synchrotron emission
    from the Galaxy, is about $5$ orders of magnitude stronger than the HI signal.
    Besides, the free-free emission of the Galaxy, as well as the extragalactic point
    sources, can be about $3$ orders of magnitude stronger than the HI signal.
  prefs: []
  type: TYPE_NORMAL
- en: 'Considerable work has been done to subtract foreground, proposing some methods
    for deducting HI foreground. There are advantages and disadvantages in each of
    these methods, which are mainly divided into two categories: non-blind and blind
    algorithms. Non-blind algorithms mainly rely on the assumption of a smooth foreground
    spectrum model by fitting a few of low-order polynomials to extract the smooth
    foreground components. However, the complex systematic effects of the actual data
    can seriously undermine the assumption of smooth foreground. The non-blind algorithm
    performs poorly in the actual data analysis, and it is difficult to eliminate
    the foreground interference. Blind algorithms are commonly used foreground subtraction
    methods in the analysis of HI IM real data, mainly including principal component
    analysis (PCA) (de Oliveira-Costa et al., [2008](#bib.bib18)), fast independent
    component analysis (fastICA) (Hothi et al., [2020](#bib.bib25)), correlated component
    analysis (CCA) (Bonaldi & Brown, [2015](#bib.bib13)), Gaussian process (Mertens
    et al., [2018](#bib.bib36); Soares et al., [2022](#bib.bib48)), etc. The blind
    algorithms can cope with the simple systematic effects and improve the accuracy
    of foreground subtraction to a certain extent. But they usually cause serious
    signal loss and have some randomness and instability when dealing with complex
    beams.'
  prefs: []
  type: TYPE_NORMAL
- en: These foreground subtraction methods all rely on the assumption of smoothness
    of the foreground emission spectrum. The instrument’s systematic effects are entangled
    with the foreground, leading to unsatisfactory foreground subtraction by these
    algorithms. Therefore, the development of new algorithms for HI foreground subtraction
    is imminent. Deep learning forms more abstract high-level features through the
    underlying features to discover how the instrumental effects impact the signal.
    Therefore, we wish to use the deep learning approach to deal with this challenge.
  prefs: []
  type: TYPE_NORMAL
- en: Deep learning has unique advantages in feature recognition of complex systems (Makinen
    et al., [2021](#bib.bib31); Villanueva-Domingo & Villaescusa-Navarro, [2021](#bib.bib52)).
    In the work of Makinen et al. ([2021](#bib.bib31)), the foreground subtraction
    with U-Net, one of the convlution network deep learning methods, has been generally
    discussed. The main objective of this study is to apply deep learning algorithms
    in foreground subtraction to eliminate instrumental effects and improve foreground
    subtraction. We plan to investigate the application of deep learning in eliminating
    instrumental effects in foreground subtraction through a series of simulations.
    The instrumental effects considered in this work mainly include the frequency
    dependence of the antenna beam and the sidelobe leakage. At present, the analysis
    is based primarily on the antenna beam model of MeerKAT (Matshawule et al., [2021](#bib.bib34)).
    We use simulation software to simulate the instrumental effects from the HI observed
    signal, foreground, and the introduction of beam models of different complexities.
    These simulated data are used as training set, test set, and validation set, respectively,
    to study applying the U-Net deep learning method to eliminate the instrumental
    effects and optimize the foreground reduction.
  prefs: []
  type: TYPE_NORMAL
- en: 'The rest of the paper is organized as follows: In Section [2](#S2 "2 Sky simulation
    ‣ Eliminating Primary Beam Effect in Foreground Subtraction of Neutral Hydrogen
    Intensity Mapping Survey with Deep Learning") we introduce our simulation. In
    Section [3](#S3 "3 Primary beam model ‣ Eliminating Primary Beam Effect in Foreground
    Subtraction of Neutral Hydrogen Intensity Mapping Survey with Deep Learning")
    we consider the frequency dependence of the antenna beam and the sidelobe leakage.
    In Section [4](#S4 "4 U-Net network ‣ Eliminating Primary Beam Effect in Foreground
    Subtraction of Neutral Hydrogen Intensity Mapping Survey with Deep Learning")
    we explain how PCA and deep learning work to remove the foreground. In Section [5](#S5
    "5 Results and discussion ‣ Eliminating Primary Beam Effect in Foreground Subtraction
    of Neutral Hydrogen Intensity Mapping Survey with Deep Learning") we show the
    results in our analysis and make some discussions. We conclude in Section [6](#S6
    "6 Conclusion ‣ Eliminating Primary Beam Effect in Foreground Subtraction of Neutral
    Hydrogen Intensity Mapping Survey with Deep Learning").'
  prefs: []
  type: TYPE_NORMAL
- en: 2 Sky simulation
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In this section, we describe the simulated sky components used in our analysis,
    including the cosmological HI signal (Section [2.1](#S2.SS1 "2.1 Cosmological
    signal ‣ 2 Sky simulation ‣ Eliminating Primary Beam Effect in Foreground Subtraction
    of Neutral Hydrogen Intensity Mapping Survey with Deep Learning")), foreground
    emission (Section [2.2](#S2.SS2 "2.2 Foreground components ‣ 2 Sky simulation
    ‣ Eliminating Primary Beam Effect in Foreground Subtraction of Neutral Hydrogen
    Intensity Mapping Survey with Deep Learning")), and white Gaussian noise (Section [2.3](#S2.SS3
    "2.3 White noise ‣ 2 Sky simulation ‣ Eliminating Primary Beam Effect in Foreground
    Subtraction of Neutral Hydrogen Intensity Mapping Survey with Deep Learning")).
    The simulated sky components are generated using the publicly available package,
    i.e., Cosmological Realizations for Intensity Mapping Experiments (CRIME; [http://intensitymapping.physics.ox.ac.uk/CRIME.html](http://intensitymapping.physics.ox.ac.uk/CRIME.html)) (Alonso
    et al., [2014](#bib.bib3)). In the following, we briefly introduce the simulation
    method. The simulated sky components are all given in full sky using the HEALPix
    pixelization strategy (Górski et al., [2005](#bib.bib23)). Given the low angular
    resolution requirement, we use the map with $N_{\rm side}=256$ corresponding to
    an angular resolution of $13.73~{}{\rm arcmin}$, which is good enough for the
    HI IM experiments in the near future. In the meanwhile, we consider the frequency
    range spanning between $900~{}{\rm MHz}$ and $1050~{}{\rm MHz}$.
  prefs: []
  type: TYPE_NORMAL
- en: 2.1 Cosmological signal
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The mean brightness temperature of HI 21-cm emission from redshift $z$ is
  prefs: []
  type: TYPE_NORMAL
- en: '|  | $\bar{T}_{\rm HI}(z)=190.55~{}{\rm mK}\frac{\Omega_{\rm b}h(1+z)^{2}x_{\rm
    HI}(z)}{\sqrt{\Omega_{\rm m}(1+z)^{3}+\Omega_{\rm\Lambda}}},$ |  | (1) |'
  prefs: []
  type: TYPE_TB
- en: where $h=H_{0}/(100{\rm~{}km~{}s^{-1}~{}Mpc^{-1}})$ is the dimensionless Hubble
    constant, $x_{\rm HI}$ is the fraction of the HI mass in the total baryons, and
    $\Omega_{\rm b}$, $\Omega_{\rm m}$, and $\Omega_{\Lambda}$ are the baryon, total
    matter, and dark energy density fractions, respectively. The HI brightness temperature
    fluctuation is expressed as
  prefs: []
  type: TYPE_NORMAL
- en: '|  | $T_{\rm HI}(z,\hat{\bf n})=\bar{T}_{\rm HI}(z)(1+\delta_{\rm HI}(z,\hat{\bf
    n})),$ |  | (2) |'
  prefs: []
  type: TYPE_TB
- en: where $\delta_{\rm HI}(z,\hat{\bf n})$ is the HI overdensity field in redshift
    space. The final simulated maps are generated using uniform frequency slices according
    to $z+1=\nu_{0}/\nu$, where $\nu_{0}=1420.406~{}{\rm MHz}$ is the HI 21-cm emission
    rest frame frequency. The HI fluctuation signal is simulated using the lognormal
    realization with power spectrum of (Alonso et al., [2014](#bib.bib3); Olivari
    et al., [2018](#bib.bib39))
  prefs: []
  type: TYPE_NORMAL
- en: '|  | $C_{\rm\ell}^{\rm HI}(\nu_{1},\nu_{2})=\frac{2}{\pi}\int{\rm d}k~{}k^{2}P_{\rm
    DM}(k)W_{\ell,\nu_{1}}(k)W_{\ell,\nu_{2}}(k),$ |  | (3) |'
  prefs: []
  type: TYPE_TB
- en: where $P_{\rm DM}(k)$ is the underlying dark matter power spectrum at redshift
    $z=0$, and $W_{\ell,\nu}$ is the window function defined as
  prefs: []
  type: TYPE_NORMAL
- en: '|  | $\begin{split}W_{\ell,\nu_{i}}(k)=\int&amp;{\rm d}z~{}\bar{T}_{\rm HI}(z)\phi(\nu_{i},z)D(z)\\
    &amp;\times\Big{(}b(z)j_{\ell}(k\chi)-f(z)j^{\prime\prime}_{\ell}(k\chi)\Big{)},\end{split}$
    |  | (4) |'
  prefs: []
  type: TYPE_TB
- en: where $j_{\ell}$ is the $\ell$-th spherical Bessel function, $\phi(\nu_{i},z)$
    is the frequency selection function centering at $\nu_{i}$, $D(z)$ is the growth
    factor, $f(z)$ is the growth rate and $b(z)$ is the linear bias of the HI density
    with respect to the underlying dark matter density, i.e. $\delta_{\rm HI}=b(z)\delta_{\rm
    DM}$.
  prefs: []
  type: TYPE_NORMAL
- en: In our simulation, we use the best-fit cosmological parameters from the Placnk
    2018 $\Lambda$CDM results (Aghanim et al., [2020](#bib.bib2)), i.e., $H_{0}=67.7$
    km s^(-1) Mpc^(-1), $\Omega_{\rm b}=0.049$, $\Omega_{\rm m}=0.311$, $\Omega_{\Lambda}=0.689$,
    and $\sigma_{8}=0.81$. As an example, one simulated HI map of frequency slice
    at $\nu=1000~{}{\rm MHz}$ is shown in Figure [1](#S2.F1 "Figure 1 ‣ 2.2 Foreground
    components ‣ 2 Sky simulation ‣ Eliminating Primary Beam Effect in Foreground
    Subtraction of Neutral Hydrogen Intensity Mapping Survey with Deep Learning").
  prefs: []
  type: TYPE_NORMAL
- en: 2.2 Foreground components
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The foreground consists of many distinct components that emit via different
    emission mechanisms. Following the analysis in the literature, we consider four
    different foreground components in our simulation, i.e., the Galactic synchrotron
    emission, the Galactic free-free emission, the extragalactic free-free emission,
    and the extragalactic point sources, which are known as the major contamination
    of the HI signal.
  prefs: []
  type: TYPE_NORMAL
- en: The foreground is simulated using two different methods according to two different
    angular distributions, i.e., the anisotropic and isotropic ones. The Galactic
    synchrotron is produced by the accelerated motion of energetic charged particles
    dispersed in the Galactic magnetic field. Its angular structure is highly anisotropic,
    where the brightness temperature grows steeply towards the Galactic plane.
  prefs: []
  type: TYPE_NORMAL
- en: In the simulations, the Galactic synchrotron amplitude template is based on
    the Haslam map at $408$ MHz (Haslam et al., [1982](#bib.bib24)). The Galactic
    synchrotron emission is simulated by extrapolating the Haslam map’s brightness
    temperature $T_{\rm Haslam}(\hat{\bf n})$ to other frequencies with direction
    dependent spectral index. The spectral index, $\gamma(\hat{\bf n})$, is generated
    with the Planck Sky Model (PSM) (Delabrouille et al., [2013](#bib.bib20)). The
    anisotropic Galactic synchrotron emission is simulated via
  prefs: []
  type: TYPE_NORMAL
- en: '|  | $T_{{\rm syn},0}(\nu,\hat{\bf n})=T_{\rm Haslam}(\hat{\bf n})\left(\frac{408~{}{\rm
    MHz}}{\nu}\right)^{\gamma(\hat{\bf n})}.$ |  | (5) |'
  prefs: []
  type: TYPE_TB
- en: Due to the low resolution of the Haslam sky map, the angular structure information
    is lost at small scales. We assume that the anisotropy of Galactic synchrotron
    emission can be neglected at small scales. Therefore, based on the following form
    of spectrum,
  prefs: []
  type: TYPE_NORMAL
- en: '|  | $C^{\rm fg}_{\ell}(\nu_{1},\nu_{2})=A\left(\frac{\ell_{\rm ref}}{\ell}\right)^{\beta}\left(\frac{\nu_{\rm
    ref}^{2}}{\nu_{1}\nu_{2}}\right)^{\alpha}\exp{\left(-\frac{\log^{2}(\nu_{1}/\nu_{2})}{2\xi^{2}}\right)},$
    |  | (6) |'
  prefs: []
  type: TYPE_TB
- en: we generate the isotropic structure of synchrotron emission using the method
    implemented by Santos, Cooray and Knox (SCK) (Santos et al., [2005](#bib.bib44))
    with random realizations, $\delta T_{\rm syn}(\nu,\hat{\bf n})$. In Equation ([6](#S2.E6
    "In 2.2 Foreground components ‣ 2 Sky simulation ‣ Eliminating Primary Beam Effect
    in Foreground Subtraction of Neutral Hydrogen Intensity Mapping Survey with Deep
    Learning")), $A$ is the amplitude of power spectrum, $\xi$ is the frequency-space
    correlation length of the emission. We use the reference scale $\ell_{\rm ref}=1000$
    and the reference frequency $\nu_{\rm ref}=130~{}{\rm MHz}$. The rest parameters
    are listed in Table [1](#S2.T1 "Table 1 ‣ 2.2 Foreground components ‣ 2 Sky simulation
    ‣ Eliminating Primary Beam Effect in Foreground Subtraction of Neutral Hydrogen
    Intensity Mapping Survey with Deep Learning"). In order to restrict the synchrotron
    simulation to only the small scales, the random realizations are rescaled to $0$
    on the scales overlapping with the Haslam map’s resolution scale before adding
    to the final Galactic synchrotron map,
  prefs: []
  type: TYPE_NORMAL
- en: '|  | $T_{{\rm syn}}(\nu,\hat{\bf n})=T_{{\rm syn},0}(\nu,\hat{\bf n})+\delta
    T_{\rm syn}(\nu,\hat{\bf n}).$ |  | (7) |'
  prefs: []
  type: TYPE_TB
- en: Figure [1](#S2.F1 "Figure 1 ‣ 2.2 Foreground components ‣ 2 Sky simulation ‣
    Eliminating Primary Beam Effect in Foreground Subtraction of Neutral Hydrogen
    Intensity Mapping Survey with Deep Learning") shows an example of the simulated
    Galactic synchrotron map at the frequency of $1000~{}{\rm MHz}$.
  prefs: []
  type: TYPE_NORMAL
- en: 'Table 1: The parameters of isotropic foreground power spectrum model [see Equation ([6](#S2.E6
    "In 2.2 Foreground components ‣ 2 Sky simulation ‣ Eliminating Primary Beam Effect
    in Foreground Subtraction of Neutral Hydrogen Intensity Mapping Survey with Deep
    Learning"))] for different components. The pivot values are $\ell_{\rm ref}=1000$
    and $\nu_{\rm ref}=130$ MHz.'
  prefs: []
  type: TYPE_NORMAL
- en: '| Foreground Component | $A~{}[{\rm mK}^{2}]$ | $\beta$ | $\alpha$ | $\xi$
    |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| Iso. Gal. Syn. | $700$ | $2.4$ | $2.80$ | $4.0$ |'
  prefs: []
  type: TYPE_TB
- en: '| Point sources | $57.0$ | $1.1$ | $2.07$ | $1.0$ |'
  prefs: []
  type: TYPE_TB
- en: '| Galactic free-free | $0.088$ | $3.0$ | $2.15$ | $35$ |'
  prefs: []
  type: TYPE_TB
- en: '| Extragalactic free-free | $0.014$ | $1.0$ | $2.10$ | $35$ |'
  prefs: []
  type: TYPE_TB
- en: Besides, the SCK model is also used to simulate free-free emission and extragalactic
    point sources.
  prefs: []
  type: TYPE_NORMAL
- en: Extragalactic point sources are radio galaxies radiating from outside the Milky
    Way. Both neighboring radio galaxies and high-redshift radio galaxies are included.
    For high-redshift galaxies, their association with cosmological signals needs
    to be considered. We use the SCK model to simulate radio galaxies with certain
    clustering properties by introducing an LSS power spectrum model of radio galaxies
    through Equation ([6](#S2.E6 "In 2.2 Foreground components ‣ 2 Sky simulation
    ‣ Eliminating Primary Beam Effect in Foreground Subtraction of Neutral Hydrogen
    Intensity Mapping Survey with Deep Learning")), and the specific simulation parameters
    are shown in Table [1](#S2.T1 "Table 1 ‣ 2.2 Foreground components ‣ 2 Sky simulation
    ‣ Eliminating Primary Beam Effect in Foreground Subtraction of Neutral Hydrogen
    Intensity Mapping Survey with Deep Learning"). Strictly speaking, high-redshift
    radio galaxies are the background components of the HI signal. However, their
    interference effect on the HI is the same as the foreground, and they are also
    used as foreground components in the simulation. Figure [1](#S2.F1 "Figure 1 ‣
    2.2 Foreground components ‣ 2 Sky simulation ‣ Eliminating Primary Beam Effect
    in Foreground Subtraction of Neutral Hydrogen Intensity Mapping Survey with Deep
    Learning") shows an example of the simulated extragalactic point source map at
    the frequency of $1000~{}{\rm MHz}$.
  prefs: []
  type: TYPE_NORMAL
- en: Free-free emission is the electromagnetic radiation produced by the deceleration
    of high-speed electrons when deflected by an interstellar ion, i.e., bremsstrahlung.
    Free-free emission is not homogeneous, and considering that it is exceptionally
    smooth frequency dependence and its subdominant amplitude, to simplify the simulation,
    we approximate the free-free emission as isotropic and introduce its distribution
    power spectrum model through Equation ([6](#S2.E6 "In 2.2 Foreground components
    ‣ 2 Sky simulation ‣ Eliminating Primary Beam Effect in Foreground Subtraction
    of Neutral Hydrogen Intensity Mapping Survey with Deep Learning")) to simulate
    the free-free emission sky map. An example of Galactic and extragalactic free-free
    emission maps at $1000~{}{\rm MHz}$ are shown in Figures [1](#S2.F1 "Figure 1
    ‣ 2.2 Foreground components ‣ 2 Sky simulation ‣ Eliminating Primary Beam Effect
    in Foreground Subtraction of Neutral Hydrogen Intensity Mapping Survey with Deep
    Learning") and [1](#S2.F1 "Figure 1 ‣ 2.2 Foreground components ‣ 2 Sky simulation
    ‣ Eliminating Primary Beam Effect in Foreground Subtraction of Neutral Hydrogen
    Intensity Mapping Survey with Deep Learning").
  prefs: []
  type: TYPE_NORMAL
- en: The total foreground map is generated by combining all different components,
  prefs: []
  type: TYPE_NORMAL
- en: '|  | $\begin{split}T_{\rm fg}(\nu,\hat{\bf n})&amp;=T_{\rm syn}(\nu,\hat{\bf
    n})+T_{\rm PS}(\nu,\hat{\bf n})\\ &amp;+T_{\rm GFF}(\nu,\hat{\bf n})+T_{\rm EGFF}(\nu,\hat{\bf
    n}),\end{split}$ |  | (8) |'
  prefs: []
  type: TYPE_TB
- en: in terms of Galactic synchrotron map $T_{\rm syn}(\nu,\hat{\bf n})$, extragalactic
    point source map $T_{\rm PS}(\nu,\hat{\bf n})$, Galactic free-free emission map
    $T_{\rm GFF}(\nu,\hat{\bf n})$, and extragalactic free-free emission map $T_{\rm
    EGFF}(\nu,\hat{\bf n})$.
  prefs: []
  type: TYPE_NORMAL
- en: '![Refer to caption](img/6d67d1fdbc4d74cea069c10169339c0c.png)![Refer to caption](img/ba4e6627b4bb0820b049f8d58af981ba.png)![Refer
    to caption](img/61c2b2b47093b1b19f82323048daa791.png)![Refer to caption](img/5438e48cd658130a387daa5861da4d55.png)![Refer
    to caption](img/e98522ce2b5ba4c2d60c57e65b3d1ea4.png)![Refer to caption](img/2c61b020a55e1e0068bcf27f5839206c.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 1: Simulated sky maps from different components. Panels (a)–(f) are
    the maps of HI, white noise, Galactic synchrotron, Galactic free-free, extragalactic
    free-free, and extragalactic point source, respectively. The maps are shown using
    the histogram equalized color mapping to amplify the contrast of the image.'
  prefs: []
  type: TYPE_NORMAL
- en: 2.3 White noise
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: We also consider the instrumental noise and its impact on the observed HI signal.
    The instrument generates both the uncorrelated white noise and the correlated
    $1/f$ noise (Li et al., [2021](#bib.bib27)). The effect of $1/f$ noise is related
    to the detailed scanning strategy. To simplify the simulation, we only consider
    the white noise and add onto our simulated maps a Gaussian random realization,
    $T_{\rm noise}(\nu,\hat{\bf n})$, with root mean square (RMS)
  prefs: []
  type: TYPE_NORMAL
- en: '|  | $\sigma_{\rm noise}=T_{\rm sys}\sqrt{\frac{4\pi f_{\rm sky}}{\Omega_{\rm
    beam}N_{\rm dish}t_{\rm obs}\Delta\nu}},$ |  | (9) |'
  prefs: []
  type: TYPE_TB
- en: where $N_{\rm dish}$ is the number of telescope dishes or feeds, $\Omega_{\rm
    beam}\approx{(\lambda}/{\rm D})^{2}$ is the solid angle of the telescope main
    beam, $t_{\rm obs}$ is the total observation time, and $\Delta\nu$ is the frequency
    resolution.
  prefs: []
  type: TYPE_NORMAL
- en: Since there is no full-sky experiment for HI, we refer to the observational
    parameters of a currently available experiment, the MeerKAT telescope, for a simple
    simulation of the noise. The analysis reveals that the instrumental noise is much
    smaller relative to the foreground, so we only briefly consider the instrumental
    noise. We fix the sensitivity of telescope $T_{\rm sys}=16~{}{\rm K}$, the number
    of dishes $N_{\rm dish}=64$, the observation time $t_{\rm obs}=8000~{}{\rm h}$,
    the sky coverage $f_{\rm sky}=1$, the frequency resolution $\Delta\nu=2.34375~{}{\rm
    MHz}$, and the dish diameter $D=13.5{\rm m}$. So, the uncorrelated Gaussian white
    noise with an RMS $\sigma_{\rm noise}=0.25~{}{\rm mK}$ . As an example, one simulated
    noise map of frequency slice at $\nu=1000~{}{\rm MHz}$ is shown in Figure [1](#S2.F1
    "Figure 1 ‣ 2.2 Foreground components ‣ 2 Sky simulation ‣ Eliminating Primary
    Beam Effect in Foreground Subtraction of Neutral Hydrogen Intensity Mapping Survey
    with Deep Learning").
  prefs: []
  type: TYPE_NORMAL
- en: The foreground parameters listed in Table [1](#S2.T1 "Table 1 ‣ 2.2 Foreground
    components ‣ 2 Sky simulation ‣ Eliminating Primary Beam Effect in Foreground
    Subtraction of Neutral Hydrogen Intensity Mapping Survey with Deep Learning")
    are fixed in our simulations. In practice, these parameters may differ, resulting
    in different foreground features. However, such variation of parameters does not
    increase the degrees of freedom of the foreground components. A preprocessing
    with blind foreground subtraction, such as PCA, can remove the major foreground
    components without accurate measurements of the foreground parameters. The residuals
    have subdominant effects when the foreground parameters are changed. To make the
    analysis easier, we skip generating the robust training set simulations by varying
    the foreground parameters.
  prefs: []
  type: TYPE_NORMAL
- en: 3 Primary beam model
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The final simulated sky map is the linear combination of the different components,
  prefs: []
  type: TYPE_NORMAL
- en: '|  | $T_{\rm sky}(\nu,\hat{\bf n})=T_{\rm HI}(\nu,\hat{\bf n})+T_{\rm fg}(\nu,\hat{\bf
    n})+T_{\rm noise}(\nu,\hat{\bf n}).$ |  | (10) |'
  prefs: []
  type: TYPE_TB
- en: The observed sky map is the observational sky map convolved with the telescope’s
    primary beam.
  prefs: []
  type: TYPE_NORMAL
- en: '![Refer to caption](img/7f8d9b03916e02c02514539c310e893c.png)![Refer to caption](img/3c84e8ed10b27b0aec705a727efde6cd.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 2: MeerKAT beam model (Matshawule et al., [2021](#bib.bib34)). Panel
    (a): Comparison of primary beam models, the standard Gaussian model (orange) and
    the Cosine model (blue), at 1000 MHz. Panel (b): The $\lambda/D$ normalized beam
    size as a function of frequency for the Gaussian model [orange, see Equation ([12](#S3.E12
    "In 3 Primary beam model ‣ Eliminating Primary Beam Effect in Foreground Subtraction
    of Neutral Hydrogen Intensity Mapping Survey with Deep Learning"))] and the Cosine
    model [blue, see Equation ([14](#S3.E14 "In 3 Primary beam model ‣ Eliminating
    Primary Beam Effect in Foreground Subtraction of Neutral Hydrogen Intensity Mapping
    Survey with Deep Learning"))].'
  prefs: []
  type: TYPE_NORMAL
- en: The frequency dependence of the primary beam, such as the frequency evolution
    of the beam size, can complicate the foreground emission. Such a feature has been
    noticed in most of the HI IM experiments and can be overcome by degrading the
    beam size to the largest one (Switzer et al., [2013](#bib.bib51)). To simulate
    such an effect, we use a simple Gaussian beam model with frequency-dependent beam
    size,
  prefs: []
  type: TYPE_NORMAL
- en: '|  | $B_{\rm G}(\nu,\theta)=\exp\left[-4\ln 2\left(\frac{\theta}{\Delta\theta_{\rm
    G}(\nu)}\right)^{2}\right],$ |  | (11) |'
  prefs: []
  type: TYPE_TB
- en: where $\Delta\theta_{\rm G}(\nu)$ is the full width at half maximum (FWHM) of
    the primary beam, i.e., frequency-dependent beam size. Such a frequency dependence
    is modeled as (Matshawule et al., [2021](#bib.bib34))
  prefs: []
  type: TYPE_NORMAL
- en: '|  | $\Delta\theta_{\rm G}(\nu)=1.16\frac{\lambda(\nu)}{D},$ |  | (12) |'
  prefs: []
  type: TYPE_TB
- en: where $\lambda(\nu)=c/\nu$ is wavelength at frequency $\nu$ and $c$ is the speed
    of light. The factor of $1.16$ is a good approximation to the MeerKAT primary
    beam. We take the MeerKAT beam as the example throughout this work and use $D=13.5~{}{\rm
    m}$.
  prefs: []
  type: TYPE_NORMAL
- en: The Gaussian beam model only includes the frequency variation of the primary
    beam size and is not accurate enough to recover the actual primary beam feature.
    Using the MeerKAT L-band full-polarization ‘astro-holographic’ observation, Asad
    et al. ([2021](#bib.bib7)) reconstructed a Zernike-based beam model and provided
    a software tool named EIDOS ([https://github.com/ratt-ru/eidos](https://github.com/ratt-ru/eidos)),
    which is the most accurate beam model for MeerKAT dishes. With such a model, two
    important features can be seen clearly. One is the primary beam sidelobes. The
    EIDOS software provides the accurate primary beam sidelobe feature within $5^{\circ}$
    radius. To extend the sidelobes to a large separation angle, following Matshawule
    et al. ([2021](#bib.bib34)), we use a cosine-tapered field illumination function
    to produce the sidelobe pattern,
  prefs: []
  type: TYPE_NORMAL
- en: '|  | $B_{\rm C}(\nu,\theta)=\left[\frac{\cos(1.189\pi/\Delta\theta_{\rm C}(\nu))}{1-4(1.189\theta/\Delta\theta_{\rm
    C}^{2}(\nu))}\right]^{2},$ |  | (13) |'
  prefs: []
  type: TYPE_TB
- en: which is called the Cosine beam model in this work. The primary beam patterns
    of the Gaussian and Cosine beam models at the frequency of $1000$ MHz are shown
    in Figure [2](#S3.F2 "Figure 2 ‣ 3 Primary beam model ‣ Eliminating Primary Beam
    Effect in Foreground Subtraction of Neutral Hydrogen Intensity Mapping Survey
    with Deep Learning").
  prefs: []
  type: TYPE_NORMAL
- en: The Cosine beam model also has the frequency-dependent beam size, $\Delta\theta_{\rm
    C}(\nu)$. Another important primary beam feature produced with the EIDOS software
    is that the beam size follows the frequency evolution as expressed in Equation ([12](#S3.E12
    "In 3 Primary beam model ‣ Eliminating Primary Beam Effect in Foreground Subtraction
    of Neutral Hydrogen Intensity Mapping Survey with Deep Learning")) but also exhibits
    a low-level frequency-dependent ripple. Such a ripple can be well modeled with
    a sinusoidal oscillation on top of a high order polynomial function (Matshawule
    et al., [2021](#bib.bib34)),
  prefs: []
  type: TYPE_NORMAL
- en: '|  | $\Delta\theta_{\rm C}(\nu)=\frac{\lambda(\nu)}{D}\left[\sum_{d=0}^{8}a_{d}\hat{\nu}^{d}+A\sin\left(\frac{2\pi\hat{\nu}}{T}\right)\right],$
    |  | (14) |'
  prefs: []
  type: TYPE_TB
- en: where $\hat{\nu}=\nu/{\rm MHz}$, $A=0.1$, $T=20$, and $a_{d}=\{3.4\times 10^{-21},\
    -3.0\times 10^{-17},\ -1.2\times 10^{-11},\ -2.6\times 10^{-10},\ 3.5\times 10^{-7},\
    -3.0\times 10^{-4},\ 0.16449,\ -50.37020,\ 6704.28133\}$. The $\lambda/D$ normalized
    beam sizes for both Gaussian and Cosine beam models are shown in Figure [2](#S3.F2
    "Figure 2 ‣ 3 Primary beam model ‣ Eliminating Primary Beam Effect in Foreground
    Subtraction of Neutral Hydrogen Intensity Mapping Survey with Deep Learning").
  prefs: []
  type: TYPE_NORMAL
- en: In this work, we use the Gaussian beam model as a simple case and consider the
    Cosine beam model as a realistic case. Although the model is based on the MeerKAT
    primary beam measurements, the frequency-dependent effects addressed here exist
    in most of HI IM experiments, as most of the radio telescope dishes have similar
    sidelobe and frequency-dependent ripple features.
  prefs: []
  type: TYPE_NORMAL
- en: The measured sky brightness temperature map is the convolution of the original
    sky map with one of the beam models (see Figure [3](#S3.F3 "Figure 3 ‣ 3 Primary
    beam model ‣ Eliminating Primary Beam Effect in Foreground Subtraction of Neutral
    Hydrogen Intensity Mapping Survey with Deep Learning")).
  prefs: []
  type: TYPE_NORMAL
- en: '![Refer to caption](img/097b72f950efa4eaf88c8782fb8e9199.png)![Refer to caption](img/a5f7f33641bc051e24c5f98435c06342.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 3: Different beam convolved full-sky maps at 1000 MHz: Gaussian beam
    convolved (a) and Cosine beam convolved (b) maps. The maps are shown using the
    histogram equalized color mapping to amplify the image’s contrast.'
  prefs: []
  type: TYPE_NORMAL
- en: 4 U-Net network
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: This section introduces the deep neural network architecture (3D U-Net) used
    in our foreground subtraction analysis (Çiçek et al., [2016](#bib.bib60); Fabian
    & Klaus, [2019](#bib.bib22); Makinen et al., [2021](#bib.bib31)). The U-Net network
    is a convolutional neural network (CNN) originally developed for biomedical image
    segmentation (Ronneberger et al., [2015](#bib.bib43)). It is based on the CNN,
    but with significant structural modifications. The basic U-Net architecture is
    shown in Figure [4](#S4.F4 "Figure 4 ‣ 4 U-Net network ‣ Eliminating Primary Beam
    Effect in Foreground Subtraction of Neutral Hydrogen Intensity Mapping Survey
    with Deep Learning"). In addition to the standard CNN architecture, U-Net has
    many feature channels in the upsampling part, allowing the network to propagate
    contextual information to higher resolution layers through a series of transpose
    convolutions. The main idea is to add successive layers to the traditional contractual
    network, with an upsampling operation replacing the convergence operation. As
    a result, these layers increase the output resolution. The extended path is more
    or less symmetric with the contracted part and produces an U-shaped structure (Ronneberger
    et al., [2015](#bib.bib43))
  prefs: []
  type: TYPE_NORMAL
- en: The U-Net network is mainly used to process two-dimensional images. In contrast,
    HI observations can be obtained for multiple frequency channels in a specific
    frequency range. The correlation between frequencies is the main feature distinguishing
    the HI signal from the foreground. It is shown that the foreground signal has
    a stronger frequency correlation than the HI signal. In addition, the complex
    variation of the primary beam shape of the telescope with frequency is the main
    difficulty of foreground subtraction. Therefore, introducing frequency information
    in deep learning is necessary to eliminate systematic effects and extract foreground
    information accurately. For the HI foreground subtraction problem, we adopt the
    generalized model of the U-Net network, i.e., 3D U-Net, which can include both
    angular and frequency information (Ronneberger et al., [2015](#bib.bib43); Çiçek
    et al., [2016](#bib.bib60); Villanueva-Domingo & Villaescusa-Navarro, [2021](#bib.bib52);
    Fabian & Klaus, [2019](#bib.bib22); Makinen et al., [2021](#bib.bib31)).
  prefs: []
  type: TYPE_NORMAL
- en: '![Refer to caption](img/af414abb8510d997f4fc887b15aa4b62.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 4: The U-Net architecture. Each orange box corresponds to a multi-channel
    feature map and a series of convolutions. The bottom of each box illustrates the
    number of channels and the size of the output. The dark red box and the dark blue
    box indicate the input and output. The light blue box shows the connected portion
    of the box during transpose convolutions. The down, right, and up arrows indicate
    maximum pooling, skip connection, and transpose convolutions, respectively. The
    last arrow operation denotes a $1\times 1\times 1$ convolution for mapping 64
    features to the final 3D data. This visualization is made with the PlotNeuralNet
    library ([https://github.com/HarisIqbal88/PlotNeuralNet](https://github.com/HarisIqbal88/PlotNeuralNet)).'
  prefs: []
  type: TYPE_NORMAL
- en: 4.1 Data preprocessing
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '![Refer to caption](img/8e6c2f190672a42f8f042fc43a2e75f7.png)![Refer to caption](img/8e51c821160f6ef01aaaaef55c2a45d0.png)![Refer
    to caption](img/822b2e3da1cfd6a4caca22c41f0fc9f3.png)![Refer to caption](img/e5e45f9096622954dfea1f760008c4e5.png)![Refer
    to caption](img/fddac3140902f96434f9207a2531d34a.png)![Refer to caption](img/f3a46b1c4ebd9706faef54cde6f39ae4.png)![Refer
    to caption](img/66e8166021ea0bc74d460f5904bfa9ab.png)![Refer to caption](img/9b134b31acb4fe7685e39acbe415e8a5.png)![Refer
    to caption](img/b37c76f960f64b186ba301de22875a8c.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 5: Data cubes of $214.86~{}{\rm{deg}}^{2}$ sky patches. From left to
    right, the center of the sky patches are $(l,b)=(179.648^{\circ},33.331^{\circ})$,
    $(l,b)=(224.824^{\circ},9.594^{\circ})$ and $(l,b)=(303.398^{\circ},2.836^{\circ})$,
    where $l$ and $b$ are the Galactic longitude and Galactic latitude, respectivly.
    The redshift range of the sky patches is $z\in[0.353,0.578]$. The unit of the
    sky patches is mK. Panel (a) shows the raw simulated sky patch without beam convolved,
    Panel (b) shows the Gaussian beam convolved sky patch, and Panel (c) shows the
    Cosine beam convolved sky patch.'
  prefs: []
  type: TYPE_NORMAL
- en: The core algorithm of U-Net is semantic segmentation, which is an approach detecting
    the belonging class of the object for every pixel (Ronneberger et al., [2015](#bib.bib43);
    Makinen et al., [2021](#bib.bib31); Villanueva-Domingo & Villaescusa-Navarro,
    [2021](#bib.bib52)). It can only handle 2D flat images or 3D sky patches, but
    not curved images or sky patches directly. As shown in the literature (Makinen
    et al., [2021](#bib.bib31)), the smooth components of the foreground contamination
    can be removed efficiently. However, the non-smooth foreground residual, which
    is mainly caused due to the systematic effect, challenges the detection of HI
    LSS signal. The foreground residual can be further reduced with model independent
    foreground subtraction method, such as PCA. Since the smooth components of the
    foreground are not the major problem and can be efficiently removed with the current
    foreground cleaning method, we first perform PCA on the simulated data before
    feeding to the U-Net architecture.
  prefs: []
  type: TYPE_NORMAL
- en: On the other hand, the preprocessing with PCA is necessary. Without the preprocessing
    step, the U-Net performs poorly in recovering the HI fluctuation signal. It is
    primarily due to the large dynamic range of the map amplitude (Liu et al., [2014](#bib.bib29);
    de Oliveira-Costa et al., [2008](#bib.bib18); Di Matteo et al., [2002](#bib.bib21)),
    which makes extracting correct information with the U-Net network difficult. However,
    an aggressive PCA mode subtraction can result in HI signal loss (Switzer et al.,
    [2015](#bib.bib50)). According to the simulation in the literature, the smooth
    foreground contamination can be significantly removed with a few PCA modes (Spinelli
    et al., [2022](#bib.bib49)). To avoid any HI signal loss, we subtract only the
    first three PCA modes. Subtracting a few more PCA modes, such as the first six
    PCA modes in Makinen et al. ([2021](#bib.bib31)), can potentially improve the
    benchmark. As long as the U-Net can handle the residuals, we wish to keep the
    preprocessing step to a minimum of mode subtraction. However, in practice, the
    preprocessing needs to be further improved because the actual foreground contamination
    is more complex than the simulated one.
  prefs: []
  type: TYPE_NORMAL
- en: The 3D U-Net architecture requires equal-area square image data with HEALPix
    pixelization. The full-sky map needs to be divided into several small sky patches.
    We split the full sky map into $192$ equal-area patches corresponding to the pixel
    area of HEALPix Nside of $4$. Each patch contains $64\times 64$ pixels. The full
    frequency range, i.e. $900\sim 1050$ MHz, is binned into $64$ frequency bands.
    Finally, the simulated full sky is split into $192$ sky patches with shape of
    $64\times 64\times 64$. Three sky patches, as the example, are illustrated in
    Figure [5](#S4.F5 "Figure 5 ‣ 4.1 Data preprocessing ‣ 4 U-Net network ‣ Eliminating
    Primary Beam Effect in Foreground Subtraction of Neutral Hydrogen Intensity Mapping
    Survey with Deep Learning"). The sky patches from the raw simulated sky map, Gaussian
    beam convolved sky map and Cosine beam convolved sky map are shown in the top,
    middle and bottom panels, respectively. We use the same sky segmentation method
    for the training, test, and validation datasets.
  prefs: []
  type: TYPE_NORMAL
- en: The direction-dependent spectral index is used in our simulation. The PCA is
    performed by taking the Singular Value Decomposition (SVD) of the input data cube.
    The data cube has already been reshaped into $N_{\nu}\times N_{\theta}$, where
    $N_{\nu}$ is the number of frequency channels and $N_{\theta}$ is the number of
    pointing directions. The singular modes are used as the basis functions as expressed
    in Equation (3.2) of Makinen et al. ([2021](#bib.bib31)) and the first few modes
    represent the foreground contamination. It is not necessary to assume each of
    the foreground components is separable in frequency and angular direction. The
    foreground modes estimated with PCA is not exactly the same sets of foreground
    components as the simulation input. Instead, it is the linear combination of the
    input components. As long as the foreground components can be expressed in the
    form of power law spectrum, they can be significantly subtracted.
  prefs: []
  type: TYPE_NORMAL
- en: 4.2 Loss function
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Although the dynamic amplitude range is significantly reduced with the PCA mode
    subtraction, there is still large variability between the residual foreground
    and HI signal. Following Makinen et al. ([2021](#bib.bib31)), the Logcosh loss
    function is used in our analysis,
  prefs: []
  type: TYPE_NORMAL
- en: '|  | $L(p,t)=\sum_{i}\log\cosh(p_{i}-t_{i}),$ |  | (15) |'
  prefs: []
  type: TYPE_TB
- en: where $p_{i}\in p$ denotes prediction and $t_{i}\in t$ denotes simulation target.
    The Logcosh function behaves much like the L1 norm in that it is more robust and
    less sensitive to outliers, which is the main reason we chose it.
  prefs: []
  type: TYPE_NORMAL
- en: 4.3 Training and testing
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Table 2: Description of the hyperparameters in the U-Net architecture design.'
  prefs: []
  type: TYPE_NORMAL
- en: '| Hyperparameter | Description | Prior Value | Optimum Value |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| $\eta$ | learning rate for optimizer | $10^{-2},10^{-3},10^{-4},10^{-5}$
    | $10^{-4}$ |'
  prefs: []
  type: TYPE_TB
- en: '| $\omega$ | weight decay for optimizer | $10^{-4},10^{-5},10^{-6},10^{-7}$
    | $10^{-5}$ |'
  prefs: []
  type: TYPE_TB
- en: '| $n_{\rm filter}$ | initial number of convolution filters | 8, 16, 32 | 32
    |'
  prefs: []
  type: TYPE_TB
- en: '| $b$ | batch size, i.e. number of samples per gradient descent step | 8, 16
    | 16 |'
  prefs: []
  type: TYPE_TB
- en: '| $\Omega$ | optimizer for training | Adam, NAdam | NAdam |'
  prefs: []
  type: TYPE_TB
- en: '![Refer to caption](img/1a9699fb78d3a5c9453ffaffad402f3a.png)![Refer to caption](img/8b449576c83cf99682ee46383870b680.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 6: Loss function evolution for each network as a function of the number
    of epochs. The dark blue solid line indicates the training set loss function evolution
    and the light blue dashed line indicates the validation set loss function evolution.
    Panel (a) is U-Net foreground deduction for Gaussian beam convolved maps, and
    Panel (b) is U-Net foreground deduction for Cosine beam convolved maps.'
  prefs: []
  type: TYPE_NORMAL
- en: '![Refer to caption](img/ed598cc170aee0267eee27c77ba15674.png)![Refer to caption](img/012e61d1016ab5a053f55e793f24294b.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 7: The angular power spectra of the simulated sky maps after PCA+U-Net
    foreground subtraction. Panel (a) shows the angular power spectra from the Gaussian
    beam convolved sky map, and Panel (b) shows the angular power spectra from the
    Cosine beam convolved sky map.'
  prefs: []
  type: TYPE_NORMAL
- en: The core of any CNN is the convolutional layers which are defined by the convolution
    of a number of filters on the input. The network is basically a stack of layers.
    Following Makinen et al. ([2021](#bib.bib31)), we fixed the number of convolution
    kernels to be $32$. The kernel size defines the field of view of the convolution,
    which is fixed to $3\times 3\times 3$. To obtain the required output dimensionality,
    we used “same” padding to handle the boundaries of the samples in the convolutions
    and transpose convolutions. The stride defines the step size of the kernel traversing
    the images. We use the default settings of stride equal to 1 in the convolutions
    and stride equal to 2 in the transpose convolutions.
  prefs: []
  type: TYPE_NORMAL
- en: Our selected U-Net architecture is trained end-to-end to the foreground removal
    using a set of HI foreground simulations. Table [2](#S4.T2 "Table 2 ‣ 4.3 Training
    and testing ‣ 4 U-Net network ‣ Eliminating Primary Beam Effect in Foreground
    Subtraction of Neutral Hydrogen Intensity Mapping Survey with Deep Learning")
    presents the details of the hyperparameters used in this network. The NAdam optimizer
    is used in this analysis with the default TensorFlow parameters (Reddi et al.,
    [2019](#bib.bib42)). The hyperparameters are carefully fine-tunned to optimize
    the network. The batch size is optimized to $16$ and the number of initial convolution
    filters is optimized to $32$, both of which are limited by the GPU memory. The
    initial learning rate is set to $10^{-2}$ and decayed by a factor of $10$, if
    the validation loss function is not improved after 20 epochs. In the meanwhile,
    the weight decay is also test with a set of prior values as list in Table [2](#S4.T2
    "Table 2 ‣ 4.3 Training and testing ‣ 4 U-Net network ‣ Eliminating Primary Beam
    Effect in Foreground Subtraction of Neutral Hydrogen Intensity Mapping Survey
    with Deep Learning"). Finally, we find that optimized values for learning rate
    and weight decay are $10^{-4}$ and $10^{-5}$, respectively. The total number of
    trainable parameters is $7.4\times 10^{7}$. Following Makinen et al. ([2021](#bib.bib31)),
    we apply a rectified linear unit (ReLU) activation in every convolution. In Figure [6](#S4.F6
    "Figure 6 ‣ 4.3 Training and testing ‣ 4 U-Net network ‣ Eliminating Primary Beam
    Effect in Foreground Subtraction of Neutral Hydrogen Intensity Mapping Survey
    with Deep Learning"), we show the evolution of the loss function.The dark blue
    solid line indicates the training set loss function evolution and the light blue
    dashed line indicates the validation set loss function evolution. The results
    for Gaussian beam convolved maps and Cosine beam convolved maps are shown in the
    left and right panels, respectively.
  prefs: []
  type: TYPE_NORMAL
- en: The loss function of the validation set is converged after about $20$ epochs
    and $50$ epochs for Gaussian and Cosine beam convolved maps, respectively. The
    recovered power spectra in the cases with $20$ and $100$ epochs are shown in Figure [7](#S4.F7
    "Figure 7 ‣ 4.3 Training and testing ‣ 4 U-Net network ‣ Eliminating Primary Beam
    Effect in Foreground Subtraction of Neutral Hydrogen Intensity Mapping Survey
    with Deep Learning"), where the results for Gaussian maps are shown in the left
    panel and the results for Cosine maps are shown in the right panel. Significantly,
    the recovered angular power spectra from Gaussian beam convolved maps are consistent
    between the cases with $20$ and $100$ epochs, which is because the loss function
    is converged after $20$ epochs. Although the loss function in the Cosine case
    converges after about $50$ epochs, the improvement in recovering the power spectrum
    is not obvious after $20$ epochs. Therefore, in our analysis, we adopt a 20-epoch
    calculation scheme to make our computations faster.
  prefs: []
  type: TYPE_NORMAL
- en: After completed the training, we investigated the accuracy of the network’s
    prediction. In Figure [8](#S5.F8 "Figure 8 ‣ 5 Results and discussion ‣ Eliminating
    Primary Beam Effect in Foreground Subtraction of Neutral Hydrogen Intensity Mapping
    Survey with Deep Learning"), we show the foreground subtraction results for PCA
    and PCA+U-Net in the presence of Gaussian and Cosine instrumental effects.
  prefs: []
  type: TYPE_NORMAL
- en: 5 Results and discussion
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![Refer to caption](img/cce3128b79591458f07e96c0e71895b9.png)![Refer to caption](img/69defd4dae97be8786c36e189f32535f.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 8: The angular power spectra of the simulated sky maps after foreground
    subtraction. The blue, orange, and green lines show the results of the initial
    HI model, the foreground subtraction with the first 3 PCA modes, and the foreground
    subtraction with the combination of PCA and U-Net, respectively. Panel (a) shows
    the angular power spectra from the Gaussian beam convolved sky map, and Panel
    (b) shows the angular power spectra from the Cosine beam convolved sky map.'
  prefs: []
  type: TYPE_NORMAL
- en: '![Refer to caption](img/32131d42cc0bf02c9d74788d65b3004b.png)![Refer to caption](img/0a1041c199e4fe1a7298482ff146425a.png)![Refer
    to caption](img/4c66835df53cb2f9ffa6976b2d101aa2.png)![Refer to caption](img/68a153125d9f927322c3fcd91713e937.png)![Refer
    to caption](img/ea7c33b310574af7f441ada9e8b1e48d.png)![Refer to caption](img/0a90a734e2727b11ba3c5734cddc3661.png)![Refer
    to caption](img/e666fd7cd150a9441dc7855a7064dfa8.png)![Refer to caption](img/d68672893c32583497f88a53492d7dab.png)![Refer
    to caption](img/9205ee08e8ddc51d473276c3822ee754.png)![Refer to caption](img/874f2eb94e178448d5ca0fe9f213e2fa.png)![Refer
    to caption](img/8c718a279bf53fec1f5602d34890c749.png)![Refer to caption](img/9cdc864713a05b86f9eda486279788ea.png)![Refer
    to caption](img/526573235497da1cf3513a1ef32211eb.png)![Refer to caption](img/4418c1ba9ec4ddc8ebaa41940f4d41a6.png)![Refer
    to caption](img/e02e822b555836a147904eda88aadae4.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 9: Data cubes of the same sky patches as shown in Figure [5](#S4.F5
    "Figure 5 ‣ 4.1 Data preprocessing ‣ 4 U-Net network ‣ Eliminating Primary Beam
    Effect in Foreground Subtraction of Neutral Hydrogen Intensity Mapping Survey
    with Deep Learning"), but with foreground subtracted. From top to bottom are initial
    HI map (a), Gaussian beam convolved map cleaned with PCA (b), Gaussian beam convolved
    map cleaned with PCA+U-Net (c), Cosine beam convolved map cleaned with PCA (d),
    and Cosine beam convolved map cleaned with PCA+U-Net (e). The unit of the cube
    is mK.'
  prefs: []
  type: TYPE_NORMAL
- en: '![Refer to caption](img/cd5abed8f25e519dfd1cac6d1d4c2a3a.png)![Refer to caption](img/29493f9fffc304813744d072aceda53d.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 10: The 2D auto-correlation power spectrum ratio of the PCA cleaned
    map and the initial HI model. Panel (a) shows the result from the Gaussian convolved
    map and Panel (b) shows the result from the Cosine beam convolved map.'
  prefs: []
  type: TYPE_NORMAL
- en: '![Refer to caption](img/b3046c92ddb75f0620d77eb260613a7a.png)![Refer to caption](img/366d29ae17b2920254350ad52c8383ed.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 11: The 2D cross-correlation power spectrum ratio of the PCA cleaned
    map and the initial HI model. Panel (a) shows the result from the Gaussian convolved
    map and Panel (b) shows the result from the Cosine beam convolved map.'
  prefs: []
  type: TYPE_NORMAL
- en: Three different small patches of the foreground cleaned maps are shown in different
    columns of Figure [9](#S5.F9 "Figure 9 ‣ 5 Results and discussion ‣ Eliminating
    Primary Beam Effect in Foreground Subtraction of Neutral Hydrogen Intensity Mapping
    Survey with Deep Learning"). The different sky patches of the initial HI signal
    map are shown in Figure [9](#S5.F9 "Figure 9 ‣ 5 Results and discussion ‣ Eliminating
    Primary Beam Effect in Foreground Subtraction of Neutral Hydrogen Intensity Mapping
    Survey with Deep Learning"). Figures [9](#S5.F9 "Figure 9 ‣ 5 Results and discussion
    ‣ Eliminating Primary Beam Effect in Foreground Subtraction of Neutral Hydrogen
    Intensity Mapping Survey with Deep Learning") and [9](#S5.F9 "Figure 9 ‣ 5 Results
    and discussion ‣ Eliminating Primary Beam Effect in Foreground Subtraction of
    Neutral Hydrogen Intensity Mapping Survey with Deep Learning") show the sky patches
    of the Gaussian beam convolved maps cleaned with PCA and PCA+U-Net, respectively.
    Both the PCA and PCA+U-Net cleaned maps have good consistency with the initial
    HI map. It shows that both PCA and PCA+U-Net foreground subtraction approaches
    perform well, and that the systematic effect caused by the simple Gaussian beam
    model can be effectively eliminated with both methods.
  prefs: []
  type: TYPE_NORMAL
- en: Figures [9](#S5.F9 "Figure 9 ‣ 5 Results and discussion ‣ Eliminating Primary
    Beam Effect in Foreground Subtraction of Neutral Hydrogen Intensity Mapping Survey
    with Deep Learning") and [9](#S5.F9 "Figure 9 ‣ 5 Results and discussion ‣ Eliminating
    Primary Beam Effect in Foreground Subtraction of Neutral Hydrogen Intensity Mapping
    Survey with Deep Learning") show patches of Cosine beam convolved maps cleaned
    with PCA and PCA+U-Net, respectively. As we can see in Figure [9](#S5.F9 "Figure
    9 ‣ 5 Results and discussion ‣ Eliminating Primary Beam Effect in Foreground Subtraction
    of Neutral Hydrogen Intensity Mapping Survey with Deep Learning"), the PCA cleaned
    maps have extra structures. Such structures can be eliminated with the additional
    U-Net process, as shown in Figure [9](#S5.F9 "Figure 9 ‣ 5 Results and discussion
    ‣ Eliminating Primary Beam Effect in Foreground Subtraction of Neutral Hydrogen
    Intensity Mapping Survey with Deep Learning").
  prefs: []
  type: TYPE_NORMAL
- en: We can verify the foreground subtraction efficiency by comparing the angular
    power spectrum to the initial HI model. The sky patches are re-filled to their
    original positions after foreground subtraction, forming the cleaned whole sky
    map. The angular power spectrum is shown in Figure [8](#S5.F8 "Figure 8 ‣ 5 Results
    and discussion ‣ Eliminating Primary Beam Effect in Foreground Subtraction of
    Neutral Hydrogen Intensity Mapping Survey with Deep Learning"). The initial HI
    power spectrum model is shown with the blue line. The orange line shows the result
    of the simulation map cleaned with the first $3$ PCA modes. The green line shows
    the result with the combination of PCA and U-Net foreground subtractions.
  prefs: []
  type: TYPE_NORMAL
- en: 5.1 PCA foreground subtraction
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: We compare the results for the Gaussian beam convolved map and the Cosine beam
    convolved map. With the Gaussian beam convolved map, the HI signal can be recovered
    by simply subtracting a few of the PCA modes, e.g., $3$ modes subtraction in this
    analysis. The variation on large scales is due to the effect of the signal loss
    during blind foreground subtraction, and the reduction on small scales is due
    to the beam smoothing. However, if the map is convolved with the Cosine beam,
    the HI signal cannot be recovered through PCA foreground subtraction. The reason
    is that the Cosine beam model induces much more systematic effects than the Gaussian
    beam. As discussed in Section [3](#S3 "3 Primary beam model ‣ Eliminating Primary
    Beam Effect in Foreground Subtraction of Neutral Hydrogen Intensity Mapping Survey
    with Deep Learning"), with the Gaussian beam model, only the effect of beam size
    variation with frequency is induced. The Cosine beam model includes the beam sidelobes
    and the frequency-dependent beam size ripple. The intensity of the bright sources
    outside of the field of view can be observed through the beam sidelobe, which
    is non-smooth components. Meanwhile, the beam size ripple directly complicates
    the foreground spectrum shape. Such effects can be further investigated through
    the 2D power spectrum.
  prefs: []
  type: TYPE_NORMAL
- en: With the data cubes of $192$ sky patches, we estimate the 2D auto-correlation
    power spectrum and plot the ratio between the foreground cleaned map and the initial
    HI model,
  prefs: []
  type: TYPE_NORMAL
- en: '|  | $R(k_{\parallel},k_{\perp})_{\rm auto}=\frac{\bar{P}_{\rm cln}(k_{\parallel},k_{\perp})}{P_{\rm
    HI}(k_{\parallel},k_{\perp})}-1,$ |  | (16) |'
  prefs: []
  type: TYPE_TB
- en: where $\bar{P}_{\rm cln}(k_{\parallel},k_{\perp})=\frac{1}{192}\sum_{i=1}^{192}P^{i}_{\rm
    cln}(k_{\parallel},k_{\perp})$ and $P^{i}_{\rm cln}(k_{\parallel},k_{\perp})$
    is the 2D power spectrum of one foreground-cleaned sky patch. The results for
    PCA cleaned map are shown in Figure [10](#S5.F10 "Figure 10 ‣ 5 Results and discussion
    ‣ Eliminating Primary Beam Effect in Foreground Subtraction of Neutral Hydrogen
    Intensity Mapping Survey with Deep Learning"). The left panel shows the result
    of the Gaussian beam convolved map. The values of $R(k_{\parallel},k_{\perp})_{\rm
    auto}$ are generally consistent with $0$ at large scales (i.e. $k_{\perp}\lesssim
    0.06$ Mpc^(-1)), which indicates that the HI signal can be recovered via PCA at
    large scales. The negative $R(k_{\parallel},k_{\perp})_{\rm auto}$ values indicate
    the signal reduction, especially on large $k_{\perp}$. Such signal reduction is
    mainly due to the beam smoothing effect. We cannot observe significant signal
    reduction at small $k_{\parallel}$. As shown in the literature (Switzer et al.,
    [2015](#bib.bib50)), HI signal at such scales is always removed during the PCA
    foreground subtraction. However, because we only remove the first $3$ PCA modes,
    such signal loss effect is still negligible.
  prefs: []
  type: TYPE_NORMAL
- en: The result of the Cosine beam convolved map is shown in the right panel of Figure [10](#S5.F10
    "Figure 10 ‣ 5 Results and discussion ‣ Eliminating Primary Beam Effect in Foreground
    Subtraction of Neutral Hydrogen Intensity Mapping Survey with Deep Learning").
    There is significant extra power at $k_{\parallel}\sim 0.7~{}{\rm Mpc}^{-1}$.
    Such extra power is mainly due to the beam size ripple induced by the Cosine beam
    model. Our results are consistent with the simulation analysis in the literature
    (Matshawule et al., [2021](#bib.bib34)). In order to remove such a systematic
    effect, it needs aggressive mode subtraction, which can cause non-negligible HI
    signal loss (Switzer et al., [2015](#bib.bib50)).
  prefs: []
  type: TYPE_NORMAL
- en: Note that the white strips in Figure [10](#S5.F10 "Figure 10 ‣ 5 Results and
    discussion ‣ Eliminating Primary Beam Effect in Foreground Subtraction of Neutral
    Hydrogen Intensity Mapping Survey with Deep Learning") do not have any physical
    meaning, which are due to the logarithmic binning being not uniform in the linear
    $k$-space. The same is also to Figures [11](#S5.F11 "Figure 11 ‣ 5 Results and
    discussion ‣ Eliminating Primary Beam Effect in Foreground Subtraction of Neutral
    Hydrogen Intensity Mapping Survey with Deep Learning")–[13](#S5.F13 "Figure 13
    ‣ 5.2 Additional U-Net foreground subtraction ‣ 5 Results and discussion ‣ Eliminating
    Primary Beam Effect in Foreground Subtraction of Neutral Hydrogen Intensity Mapping
    Survey with Deep Learning")
  prefs: []
  type: TYPE_NORMAL
- en: In order to check the concordance between the foreground removed HI map and
    the initial HI map, we estimate the cross-correlation power spectrum, $P_{\rm
    cln,HI}(k_{\parallel},k_{\perp})$. The concordance can be evaluated with the power
    spectrum ratio between the foreground cleaned map and the initial HI map,
  prefs: []
  type: TYPE_NORMAL
- en: '|  | $R(k_{\parallel},k_{\perp})_{\rm cross}=\frac{\bar{P}_{\rm cln,HI}(k_{\parallel},k_{\perp})}{P_{\rm
    HI}(k_{\parallel},k_{\perp})}-1,$ |  | (17) |'
  prefs: []
  type: TYPE_TB
- en: where $\bar{P}_{\rm cln,HI}(k_{\parallel},k_{\perp})$ represents the averaged
    cross-correlation power spectrum across different sky patches. The results for
    PCA cleaned map are shown in Figure [11](#S5.F11 "Figure 11 ‣ 5 Results and discussion
    ‣ Eliminating Primary Beam Effect in Foreground Subtraction of Neutral Hydrogen
    Intensity Mapping Survey with Deep Learning"). The results of the Gaussian and
    Cosine beam convolved maps are shown in the left and right panels, respectively.
    Obviously, the extra power shown in $R(k_{\parallel},k_{\perp})_{\rm auto}$ of
    the Cosine beam convolved case is eliminated through the cross-correlation power
    spectrum estimator. This is because the power spectrum error due to the systematic
    effect can be eliminated through cross-correlation. The values of $R(k_{\parallel},k_{\perp})_{\rm
    cross}$ in both Gaussian and Cosine beam convolved cases show the similar trend.
    The negative $R(k_{\parallel},k_{\perp})_{\rm cross}$ values at large $k_{\perp}$
    indicate the reduction of the correlation efficiency, which is mainly due to the
    beam smoothing effect. However, although the systematic effect can be removed
    via the cross-correlation power spectrum, it still enlarges the power spectrum
    estimation error and biases the auto-correlation power spectrum. The elimination
    of the systematic effect is crucial to the auto-correlation power spectrum detection.
  prefs: []
  type: TYPE_NORMAL
- en: 5.2 Additional U-Net foreground subtraction
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '![Refer to caption](img/2abf8a44375bb67043be6352d00cb335.png)![Refer to caption](img/b00c0d79ae3f85e0e7462b05f4b0d888.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 12: The 2D auto-correlation power spectrum ratio of the U-Net cleaned
    map and the initial HI model. Panel (a) shows the result from the Gaussian convolved
    map cross the initial HI map and Panel (b) shows the result from the Cosine beam
    convolved map cross the initial HI map.'
  prefs: []
  type: TYPE_NORMAL
- en: '![Refer to caption](img/7e94654ee373c448c53c92aec2dd80ab.png)![Refer to caption](img/d850d676bcc127e780ab4a68269017d0.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 13: The 2D cross-correlation power spectrum ratio of the U-Net cleaned
    map and the initial HI model. Panel (a) shows the result from the Gaussian convolved
    map cross the initial HI map and Panel (b) shows the result from the Cosine beam
    convolved map cross the initial HI map.'
  prefs: []
  type: TYPE_NORMAL
- en: Instead of applying aggressive additional mode subtraction, we feed the residual
    maps to the U-Net architecture. The angular power spectra of the U-Net cleaned
    maps are shown with green lines in Figure [8](#S5.F8 "Figure 8 ‣ 5 Results and
    discussion ‣ Eliminating Primary Beam Effect in Foreground Subtraction of Neutral
    Hydrogen Intensity Mapping Survey with Deep Learning"). The U-Net foreground subtraction
    corrects angular power spectrum in both the Gaussian and Cosine beam convolved
    cases. But in the Gaussian beam convolved case, the correction from U-Net is not
    evident. The significant improvement can be seen from the results in the Cosine
    beam convolved map, as shown in Figure [8](#S5.F8 "Figure 8 ‣ 5 Results and discussion
    ‣ Eliminating Primary Beam Effect in Foreground Subtraction of Neutral Hydrogen
    Intensity Mapping Survey with Deep Learning"). With the additional U-Net foreground
    subtraction, the angular power spectrum deviation at large scales is significantly
    eliminated. The recovered angular power spectrum is consistent with the initial
    HI power spectrum. Next, we can further investigate it with the 2D power spectrum.
  prefs: []
  type: TYPE_NORMAL
- en: The $R(k_{\parallel},k_{\perp})_{\rm auto}$ values, as specified by Equation ([16](#S5.E16
    "In 5.1 PCA foreground subtraction ‣ 5 Results and discussion ‣ Eliminating Primary
    Beam Effect in Foreground Subtraction of Neutral Hydrogen Intensity Mapping Survey
    with Deep Learning")), in the U-Net foreground subtracted sky patches are shown
    in Figures [12](#S5.F12 "Figure 12 ‣ 5.2 Additional U-Net foreground subtraction
    ‣ 5 Results and discussion ‣ Eliminating Primary Beam Effect in Foreground Subtraction
    of Neutral Hydrogen Intensity Mapping Survey with Deep Learning"). The results
    for the Gaussian and Cosine beam convolved cases are shown in the left and right
    panels, respectively. These two results are generally consistent with each other,
    which indicates that the U-Net foreground subtraction can remove the systematic
    effect induced by either the simple Gaussian beam model or the complicated Cosine
    beam model.
  prefs: []
  type: TYPE_NORMAL
- en: The $R(k_{\parallel},k_{\perp})_{\rm cross}$ values, as specified by Equation ([17](#S5.E17
    "In 5.1 PCA foreground subtraction ‣ 5 Results and discussion ‣ Eliminating Primary
    Beam Effect in Foreground Subtraction of Neutral Hydrogen Intensity Mapping Survey
    with Deep Learning")), in the U-Net foreground subtracted sky patches are shown
    in Figure [13](#S5.F13 "Figure 13 ‣ 5.2 Additional U-Net foreground subtraction
    ‣ 5 Results and discussion ‣ Eliminating Primary Beam Effect in Foreground Subtraction
    of Neutral Hydrogen Intensity Mapping Survey with Deep Learning"), with the Gaussian
    beam convolved case in the left panel and the Cosine beam convolved case in the
    right panel, respectively. The $R(k_{\parallel},k_{\perp})_{\rm cross}$ values
    are generally $\sim 0$, indicating that the recovered HI fluctuation signal is
    consistent with the initial HI signal.
  prefs: []
  type: TYPE_NORMAL
- en: 5.3 PCA v.s. U-Net
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In Figure [8](#S5.F8 "Figure 8 ‣ 5 Results and discussion ‣ Eliminating Primary
    Beam Effect in Foreground Subtraction of Neutral Hydrogen Intensity Mapping Survey
    with Deep Learning"), PCA is effective in reducing the foreground with Gaussian
    beam, but slightly worse than the U-Net network. As can be seen in Figure [8](#S5.F8
    "Figure 8 ‣ 5 Results and discussion ‣ Eliminating Primary Beam Effect in Foreground
    Subtraction of Neutral Hydrogen Intensity Mapping Survey with Deep Learning"),
    the results of PCA are much worse than those of the U-Net when dealing with the
    Cosine beam convolutional sky map. This indicates that PCA fails in processing
    the sky map with convolved complex bundles, while the U-Net network can learn
    large scale information after the convolved bundles of the sky map. In contrast,
    the U-Net network can still recover the angular power spectrum of the original
    HI signal on large scales.
  prefs: []
  type: TYPE_NORMAL
- en: 'In Figures [10](#S5.F10 "Figure 10 ‣ 5 Results and discussion ‣ Eliminating
    Primary Beam Effect in Foreground Subtraction of Neutral Hydrogen Intensity Mapping
    Survey with Deep Learning")–[13](#S5.F13 "Figure 13 ‣ 5.2 Additional U-Net foreground
    subtraction ‣ 5 Results and discussion ‣ Eliminating Primary Beam Effect in Foreground
    Subtraction of Neutral Hydrogen Intensity Mapping Survey with Deep Learning"),
    we plotted average auto-correlation and cross-correlation power spectra in the
    lateral ($k_{\perp}$) and radial ($k_{\parallel}$) directions. We define a measure
    of concordance:'
  prefs: []
  type: TYPE_NORMAL
- en: '|  | $\Gamma={\rm mean}\left\{R(k_{\parallel},k_{\perp})_{\rm X}\right\}+1,$
    |  | (18) |'
  prefs: []
  type: TYPE_TB
- en: where ${\rm mean}\{\cdot\cdot\cdot\}$ represents the mean value across the $k_{\parallel}$–$k_{\perp}$
    bins and $R(k_{\parallel},k_{\perp})_{\rm X}$ is the spectrum ratio defined in
    Equations ([16](#S5.E16 "In 5.1 PCA foreground subtraction ‣ 5 Results and discussion
    ‣ Eliminating Primary Beam Effect in Foreground Subtraction of Neutral Hydrogen
    Intensity Mapping Survey with Deep Learning")) and ([17](#S5.E17 "In 5.1 PCA foreground
    subtraction ‣ 5 Results and discussion ‣ Eliminating Primary Beam Effect in Foreground
    Subtraction of Neutral Hydrogen Intensity Mapping Survey with Deep Learning"))
    with the subscript X denoting the auto or cross power spectrum.
  prefs: []
  type: TYPE_NORMAL
- en: We first discuss the case of auto-correlation power spectrum. We obtain the
    concordances with the original HI map using both the PCA and U-Net methods, i.e.,
    $\Gamma^{\rm gau}_{\rm pca}=60.73\%$, $\Gamma^{\rm cos}_{\rm pca}=28.46\%$, $\Gamma^{\rm
    gau}_{\rm unet}=77.38\%$, and $\Gamma^{\rm cos}_{\rm unet}=69.66\%$, respectively.
    So, it is clearly seen that the 3D U-Net method is much better than the PCA method
    in recovering the HI signal. We find that, in the case of the Gaussian beam, the
    concordance of using the U-Net method is better than that of PCA by $27.4\%$,
    and in the case of the Cosine beam, the concordance of using the U-Net method
    is better than that of PCA by $144.8\%$. The results of $R(k_{\parallel},k_{\perp})_{\rm
    cross}\sim 0$ at large scales for both the PCA and U-Net foreground subtractions
    indicate that the recovered HI fluctuation is consistent with the initial HI signal.
  prefs: []
  type: TYPE_NORMAL
- en: It should be noticed that, although the sky map is partitioned into 192 small
    sky patches, the HI fluctuation on large scales can still be properly recovered.
    This is due to the fact that either the foreground contamination or the systematic
    effect considered here are highly correlated across frequencies. The results indicate
    that, even with small sky patch observation, the systematic effect induced by
    the telescope primary beam can be well eliminated using the U-Net architecture.
    It is ideal for most of current stage HI IM experiments.
  prefs: []
  type: TYPE_NORMAL
- en: The U-Net architecture is one of the supervised deep leaning methods. It means
    that the foreground subtraction with the U-Net architecture is model dependent.
    The accuracy of the primary beam model affects the foreground subtraction efficiency.
    However, the telescope primary beam, especially for telescope arrays, can be measured
    via the ‘astro-holographic’ observation (Asad et al., [2021](#bib.bib7)). Therefore,
    the U-Net based foreground subtraction sheds new light on eliminating the primary
    beam effect for future HI IM experiments.
  prefs: []
  type: TYPE_NORMAL
- en: PCA is currently one of the most effective blind foreground subtraction methods
    that has been widely discussed in different analyses with both simulated and actual
    observational data. Due to the systematic effect, most of the blind foreground
    subtraction methods, including the PCA method, can result in either significant
    foreground residual or substantial signal loss. In this work, we show that the
    additional foreground subtraction with the U-Net network can eliminate the primary
    beam effect and improve the efficiency of PCA foreground subtraction. It can potentially
    improve other blind foreground subtraction methods, such as ICA, as well as non-blind
    foreground subtraction methods.
  prefs: []
  type: TYPE_NORMAL
- en: 6 Conclusion
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Deep learning, derived from artificial neural networks, can overcome the shortcomings
    of traditional feature extraction and matching, and has made significant breakthroughs
    in the field of image recognition. Deep learning has been very successful in astronomy
    by combining underlying features to form more abstract higher-level representations
    of attribute classes or features, trained with large amounts of specific data.
  prefs: []
  type: TYPE_NORMAL
- en: In the HI 21-cm IM survey, the foreground contamination on the cosmological
    signals is extremely severe, and the systematic effects caused by radio telescopes
    themselves further aggravate the difficulties in subtracting the foregrounds.
    These foregrounds mainly originate from Galaxy synchrotron, Galaxy free-free,
    extragalactic free-free, and extragalactic point sources emissions, which are
    in total five orders of magnitude higher than the cosmological signals in the
    HI IM survey. Therefore, finding an effective way to subtract foregrounds is one
    of the crucial challenges for the HI IM observations.
  prefs: []
  type: TYPE_NORMAL
- en: In this work, we used a similar network structure to Makinen et al. ([2021](#bib.bib31)).
    Compared with Makinen et al. ([2021](#bib.bib31)), we consider the frequency band
    of the MeerKAT telescope and, more importantly, we focus on the systematic effect
    induced by the radio telescope primary beam. For the radio telescope primary beam
    effect, we consider the Gaussian beam model as a simple case and the Cosine beam
    model as a sophisticated case. We investigate whether the deep learning method,
    concretely the U-Net algorithm in this work, can play a crucial role in eliminating
    such primary beam induced systematic effect and improving the foreground subtraction
    efficiency.
  prefs: []
  type: TYPE_NORMAL
- en: The results of PCA foreground subtraction are different between using the Gaussian
    beam convolved map and the Cosine beam convolved one. When processing the Gaussian
    beam convolved map, the recovered angular power spectrum is essentially consistent
    with the initial HI angular power spectrum. Using the 2D power spectrum, we find
    that the values of $R(k_{\parallel},k_{\perp})_{\rm auto}$ [see Equation ([16](#S5.E16
    "In 5.1 PCA foreground subtraction ‣ 5 Results and discussion ‣ Eliminating Primary
    Beam Effect in Foreground Subtraction of Neutral Hydrogen Intensity Mapping Survey
    with Deep Learning"))] are close to $0$ at large scales. It indicates that PCA
    foreground subtraction can recover part of the HI signal. While at small scales,
    the HI signal reduction is found, which is due to the beam smoothing effect.
  prefs: []
  type: TYPE_NORMAL
- en: However, when dealing with the Cosine beam covolved map, the angular power spectrum
    with $3$ PCA modes subtraction deviates significantly from the initial HI angular
    power spectrum. With the 2D power spectrum, we find that there is a significant
    extra power at $k_{\parallel}\sim 0.7~{}{\rm Mpc}^{-1}$, which is relevant to
    the beam size ripple induced by the Cosine beam model. Therefore, PCA foreground
    subtraction fails in subtracting foregrounds in the Cosine beam convolved map.
    It indicates that the PCA foreground subtraction cannot remove the complex systematic
    effect induced by a sophisticated primary beam model, such as the Cosine beam
    model.
  prefs: []
  type: TYPE_NORMAL
- en: Besides, we evaluate the concordance of the results with the cross-correlation
    power spectrum between the foreground removed HI map and the initial HI map. The
    values of $R(k_{\parallel},k_{\perp})_{\rm cross}$ [see Equation ([17](#S5.E17
    "In 5.1 PCA foreground subtraction ‣ 5 Results and discussion ‣ Eliminating Primary
    Beam Effect in Foreground Subtraction of Neutral Hydrogen Intensity Mapping Survey
    with Deep Learning"))] in both the Gaussian and Cosine beam convolved cases show
    the similar trend. The negative $R(k_{\parallel},k_{\perp})_{\rm cross}$ values
    at large $k_{\perp}$ indicate the reduction of the correlation efficiency, which
    is mainly due to the beam smoothing effect.
  prefs: []
  type: TYPE_NORMAL
- en: Instead of directly using U-Net for foreground subtraction, we conservatively
    feed the PCA-subtracted residuals into the U-Net network. When dealing with the
    map convolved with the Cosine beam, the results are significantly improved. In
    particular, the deviation of the large-scale angular power spectrum is significantly
    removed, and the recovered angular power spectrum is consistent with the initial
    HI angular power spectrum. By studying the 2D power spectrum, we find that the
    values of $R(k_{\parallel},k_{\perp})_{\rm auto}$ are consistent in general between
    using the Gaussian and Cosine beam convolved maps. We quantify the results by
    defining a measure of concordance, as indicated by Equation ([18](#S5.E18 "In
    5.3 PCA v.s. U-Net ‣ 5 Results and discussion ‣ Eliminating Primary Beam Effect
    in Foreground Subtraction of Neutral Hydrogen Intensity Mapping Survey with Deep
    Learning")). We find that, in the case of Gaussian beam, the concordance with
    the original HI map using U-Net is better than that using PCA by $27.4\%$, and
    in the case of Cosine beam, the concordance using U-Net is better than that using
    PCA by $144.8\%$. With the cross-correlation power spectrum, we find that $R(k_{\parallel},k_{\perp})_{\rm
    cross}\sim 0$, which indicates that the recovered HI signal is consistent with
    the initial HI signal. Therefore, the results show that the U-Net foreground subtraction
    method can eliminate the systematic effects caused by the telescope primary beam.
  prefs: []
  type: TYPE_NORMAL
- en: In this work, we find that the U-Net based foreground subtraction method can
    significantly improve the foreground subtraction efficiency, especially in the
    case with serious primary beam induced systematic effect. U-Net is based on the
    fully convolutional network and its architecture was modified and extended to
    work with fewer training images and to yield more precise segmentation. Such supervised
    deep learning method relies on completeness of the simulated training set. Because
    the detailed primary beam feature, as well as the systematic effect, can be different
    between different experiments, an accurate beam model is required if a different
    experiment is considered. Such beam model can be provided using either ‘astro-holographic’
    observation or EM simulation (Asad et al., [2021](#bib.bib7)). Therefore, the
    U-Net based foreground subtraction method sheds new light on recovering the HI
    power spectrum for future HI IM experiments, e.g. SKA and HERA (DeBoer et al.,
    [2017](#bib.bib19)).
  prefs: []
  type: TYPE_NORMAL
- en: acknowledgments
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: This work was supported by the National Natural Science Foundation of China
    (Grants Nos. 11975072, 11835009, 11875102, and 11690021), the Liaoning Revitalization
    Talents Program (Grant No. XLYC1905011), the Fundamental Research Funds for the
    Central Universities (Grant No. N2005030), the National 111 Project of China (Grant
    No. B16009), and the Science Research Grants from the China Manned Space Project
    (Grant No. CMS-CSST-2021-B01).
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Abdalla et al. (2021) Abdalla, E., et al. 2021, arXiv e-prints, arXiv:2107.01633.
    [https://arxiv.org/abs/2107.01633](https://arxiv.org/abs/2107.01633)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Aghanim et al. (2020) Aghanim, N., et al. 2020, Astron. Astrophys., 641, A6,
    doi: [10.1051/0004-6361/201833910](http://doi.org/10.1051/0004-6361/201833910)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Alonso et al. (2014) Alonso, D., Ferreira, P. G., & Santos, M. G. 2014, Mon.
    Not. Roy. Astron. Soc., 444, 3183, doi: [10.1093/mnras/stu1666](http://doi.org/10.1093/mnras/stu1666)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Amiri et al. (2022) Amiri, M., et al. 2022, arXiv e-prints, arXiv:2202.01242.
    [https://arxiv.org/abs/2202.01242](https://arxiv.org/abs/2202.01242)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Anderson et al. (2018) Anderson, C. J., et al. 2018, Mon. Not. Roy. Astron.
    Soc., 476, 3382, doi: [10.1093/mnras/sty346](http://doi.org/10.1093/mnras/sty346)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ansari et al. (2012) Ansari, R., Campagne, J. E., Colom, P., et al. 2012, Astron.
    Astrophys., 540, A129, doi: [10.1051/0004-6361/201117837](http://doi.org/10.1051/0004-6361/201117837)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Asad et al. (2021) Asad, K. M. B., Girard, J. N., de Villiers, M., et al. 2021,
    Monthly Notices of the Royal Astronomical Society, 502, 2970–2983, doi: [10.1093/mnras/stab104](http://doi.org/10.1093/mnras/stab104)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Bacon et al. (2020) Bacon, D. J., et al. 2020, Publ. Astron. Soc. Austral.,
    37, e007, doi: [10.1017/pasa.2019.51](http://doi.org/10.1017/pasa.2019.51)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Bagla et al. (2010) Bagla, J. S., Khandai, N., & Datta, K. K. 2010, Mon. Not.
    Roy. Astron. Soc., 407, 567, doi: [10.1111/j.1365-2966.2010.16933.x](http://doi.org/10.1111/j.1365-2966.2010.16933.x)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Bandura et al. (2014) Bandura, K., et al. 2014, Proc. SPIE Int. Soc. Opt. Eng.,
    9145, 22, doi: [10.1117/12.2054950](http://doi.org/10.1117/12.2054950)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Battye et al. (2013) Battye, R. A., Browne, I. W. A., Dickinson, C., et al.
    2013, Mon. Not. Roy. Astron. Soc., 434, 1239, doi: [10.1093/mnras/stt1082](http://doi.org/10.1093/mnras/stt1082)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Battye et al. (2004) Battye, R. A., Davies, R. D., & Weller, J. 2004, Mon. Not.
    Roy. Astron. Soc., 355, 1339, doi: [10.1111/j.1365-2966.2004.08416.x](http://doi.org/10.1111/j.1365-2966.2004.08416.x)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Bonaldi & Brown (2015) Bonaldi, A., & Brown, M. L. 2015, Mon. Not. Roy. Astron.
    Soc., 447, 1973, doi: [10.1093/mnras/stu2601](http://doi.org/10.1093/mnras/stu2601)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Bull et al. (2015) Bull, P., Ferreira, P. G., Patel, P., & Santos, M. G. 2015,
    Astrophys. J., 803, 21, doi: [10.1088/0004-637X/803/1/21](http://doi.org/10.1088/0004-637X/803/1/21)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Chang et al. (2010) Chang, T.-C., Pen, U.-L., Bandura, K., & Peterson, J. B.
    2010, Nature, 466, 463, doi: [10.1038/nature09187](http://doi.org/10.1038/nature09187)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Chang et al. (2008) Chang, T.-C., Pen, U.-L., Peterson, J. B., & McDonald, P.
    2008, Phys. Rev. Lett., 100, 091303, doi: [10.1103/PhysRevLett.100.091303](http://doi.org/10.1103/PhysRevLett.100.091303)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Chen (2012) Chen, X. 2012, Int. J. Mod. Phys. Conf. Ser., 12, 256, doi: [10.1142/S2010194512006459](http://doi.org/10.1142/S2010194512006459)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: de Oliveira-Costa et al. (2008) de Oliveira-Costa, A., Tegmark, M., Gaensler,
    B. M., et al. 2008, Mon. Not. Roy. Astron. Soc., 388, 247, doi: [10.1111/j.1365-2966.2008.13376.x](http://doi.org/10.1111/j.1365-2966.2008.13376.x)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: DeBoer et al. (2017) DeBoer, D. R., Parsons, A. R., Aguirre, J. E., et al. 2017,
    PASP, 129, 045001, doi: [10.1088/1538-3873/129/974/045001](http://doi.org/10.1088/1538-3873/129/974/045001)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Delabrouille et al. (2013) Delabrouille, J., et al. 2013, Astron. Astrophys.,
    553, A96, doi: [10.1051/0004-6361/201220019](http://doi.org/10.1051/0004-6361/201220019)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Di Matteo et al. (2002) Di Matteo, T., Perna, R., Abel, T., & Rees, M. J. 2002,
    Astrophys. J., 564, 576, doi: [10.1086/324293](http://doi.org/10.1086/324293)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Fabian & Klaus (2019) Fabian, I., & Klaus, M.-H. 2019, arXiv e-prints, arXiv:1908.02182.
    [https://arxiv.org/abs/1908.02182](https://arxiv.org/abs/1908.02182)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Górski et al. (2005) Górski, K. M., Hivon, E., Banday, A. J., et al. 2005, Astrophys.
    J., 622, 759, doi: [10.1086/427976](http://doi.org/10.1086/427976)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Haslam et al. (1982) Haslam, C. G. T., Salter, C. J., Stoffel, H., & Wilson,
    W. E. 1982, Astron. Astrophys. Suppl. Ser., 47, 1
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Hothi et al. (2020) Hothi, I., et al. 2020, Mon. Not. Roy. Astron. Soc., 500,
    2264, doi: [10.1093/mnras/staa3446](http://doi.org/10.1093/mnras/staa3446)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Li et al. (2020) Li, J., et al. 2020, Sci. China Phys. Mech. Astron., 63, 129862,
    doi: [10.1007/s11433-020-1594-8](http://doi.org/10.1007/s11433-020-1594-8)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Li et al. (2021) Li, Y., Santos, M. G., Grainge, K., Harper, S., & Wang, J.
    2021, Mon. Not. Roy. Astron. Soc., 501, 4344, doi: [10.1093/mnras/staa3856](http://doi.org/10.1093/mnras/staa3856)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Lidz et al. (2011) Lidz, A., Furlanetto, S. R., Oh, S. P., et al. 2011, Astrophys.
    J., 741, 70, doi: [10.1088/0004-637X/741/2/70](http://doi.org/10.1088/0004-637X/741/2/70)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Liu et al. (2014) Liu, A., Parsons, A. R., & Trott, C. M. 2014, Phys. Rev. D,
    90, 023018, doi: [10.1103/PhysRevD.90.023018](http://doi.org/10.1103/PhysRevD.90.023018)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Loeb & Wyithe (2008) Loeb, A., & Wyithe, S. 2008, Phys. Rev. Lett., 100, 161301,
    doi: [10.1103/PhysRevLett.100.161301](http://doi.org/10.1103/PhysRevLett.100.161301)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Makinen et al. (2021) Makinen, T. L., Lancaster, L., Villaescusa-Navarro, F.,
    et al. 2021, JCAP, 04, 081, doi: [10.1088/1475-7516/2021/04/081](http://doi.org/10.1088/1475-7516/2021/04/081)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Mao et al. (2008) Mao, Y., Tegmark, M., McQuinn, M., Zaldarriaga, M., & Zahn,
    O. 2008, Phys. Rev. D, 78, 023529, doi: [10.1103/PhysRevD.78.023529](http://doi.org/10.1103/PhysRevD.78.023529)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Masui et al. (2013) Masui, K. W., et al. 2013, Astrophys. J. Lett., 763, L20,
    doi: [10.1088/2041-8205/763/1/L20](http://doi.org/10.1088/2041-8205/763/1/L20)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Matshawule et al. (2021) Matshawule, S. D., Spinelli, M., Santos, M. G., & Ngobese,
    S. 2021, Mon. Not. Roy. Astron. Soc., 506, 5075, doi: [10.1093/mnras/stab1688](http://doi.org/10.1093/mnras/stab1688)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: McQuinn et al. (2006) McQuinn, M., Zahn, O., Zaldarriaga, M., Hernquist, L.,
    & Furlanetto, S. R. 2006, Astrophys. J., 653, 815, doi: [10.1086/505167](http://doi.org/10.1086/505167)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Mertens et al. (2018) Mertens, F. G., Ghosh, A., & Koopmans, L. V. E. 2018,
    Mon. Not. Roy. Astron. Soc., 478, 3640, doi: [10.1093/mnras/sty1207](http://doi.org/10.1093/mnras/sty1207)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Nan et al. (2011) Nan, R., Li, D., Jin, C., et al. 2011, Int. J. Mod. Phys.
    D, 20, 989, doi: [10.1142/S0218271811019335](http://doi.org/10.1142/S0218271811019335)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Newburgh et al. (2016) Newburgh, L. B., et al. 2016, Proc. SPIE Int. Soc. Opt.
    Eng., 9906, 99065X, doi: [10.1117/12.2234286](http://doi.org/10.1117/12.2234286)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Olivari et al. (2018) Olivari, L. C., Dickinson, C., Battye, R. A., et al. 2018,
    Mon. Not. Roy. Astron. Soc., 473, 4242, doi: [10.1093/mnras/stx2621](http://doi.org/10.1093/mnras/stx2621)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Peel et al. (2019) Peel, M., Wuensche, C. A., Abdalla, E., et al. 2019, Journal
    of Astronomical Instrumentation
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Pritchard & Loeb (2008) Pritchard, J. R., & Loeb, A. 2008, Phys. Rev. D, 78,
    103511, doi: [10.1103/PhysRevD.78.103511](http://doi.org/10.1103/PhysRevD.78.103511)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Reddi et al. (2019) Reddi, S. J., Kale, S., & Kumar, S. 2019, CoRR, abs/1904.09237
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ronneberger et al. (2015) Ronneberger, O., Fischer, P., & Brox, T. 2015, arXiv
    e-prints, arXiv:1505.04597. [https://arxiv.org/abs/1505.04597](https://arxiv.org/abs/1505.04597)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Santos et al. (2005) Santos, M. G., Cooray, A., & Knox, L. 2005, Astrophys.
    J., 625, 575, doi: [10.1086/429857](http://doi.org/10.1086/429857)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Santos et al. (2015) Santos, M. G., et al. 2015, PoS, AASKA14, 019, doi: [10.22323/1.215.0019](http://doi.org/10.22323/1.215.0019)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Santos et al. (2017) Santos, M. G., et al. 2017, in MeerKAT Science: On the
    Pathway to the SKA. [https://arxiv.org/abs/1709.06099](https://arxiv.org/abs/1709.06099)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Seo et al. (2010) Seo, H.-J., Dodelson, S., Marriner, J., et al. 2010, Astrophys.
    J., 721, 164, doi: [10.1088/0004-637X/721/1/164](http://doi.org/10.1088/0004-637X/721/1/164)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Soares et al. (2022) Soares, P. S., Watkinson, C. A., Cunnington, S., & Pourtsidou,
    A. 2022, Mon. Not. Roy. Astron. Soc., 510, 5872, doi: [10.1093/mnras/stab2594](http://doi.org/10.1093/mnras/stab2594)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Spinelli et al. (2022) Spinelli, M., Carucci, I. P., Cunnington, S., et al.
    2022, MNRAS, 509, 2048, doi: [10.1093/mnras/stab3064](http://doi.org/10.1093/mnras/stab3064)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Switzer et al. (2015) Switzer, E. R., Chang, T.-C., Masui, K. W., Pen, U.-L.,
    & Voytek, T. C. 2015, Astrophys. J., 815, 51, doi: [10.1088/0004-637X/815/1/51](http://doi.org/10.1088/0004-637X/815/1/51)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Switzer et al. (2013) Switzer, E. R., et al. 2013, Mon. Not. Roy. Astron. Soc.,
    434, L46, doi: [10.1093/mnrasl/slt074](http://doi.org/10.1093/mnrasl/slt074)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Villanueva-Domingo & Villaescusa-Navarro (2021) Villanueva-Domingo, P., & Villaescusa-Navarro,
    F. 2021, Astrophys. J., 907, 44, doi: [10.3847/1538-4357/abd245](http://doi.org/10.3847/1538-4357/abd245)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Wang et al. (2021) Wang, J., et al. 2021, Mon. Not. Roy. Astron. Soc., 505,
    3698, doi: [10.1093/mnras/stab1365](http://doi.org/10.1093/mnras/stab1365)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Wolz et al. (2017) Wolz, L., et al. 2017, Mon. Not. Roy. Astron. Soc., 464,
    4938, doi: [10.1093/mnras/stw2556](http://doi.org/10.1093/mnras/stw2556)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Wolz et al. (2022) —. 2022, Mon. Not. Roy. Astron. Soc., 510, 3495, doi: [10.1093/mnras/stab3621](http://doi.org/10.1093/mnras/stab3621)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Wu et al. (2021) Wu, F., et al. 2021, Mon. Not. Roy. Astron. Soc., 506, 3455,
    doi: [10.1093/mnras/stab1802](http://doi.org/10.1093/mnras/stab1802)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Wuensche et al. (2021) Wuensche, C. A., et al. 2021, arXiv e-prints, arXiv:2107.01634.
    [https://arxiv.org/abs/2107.01634](https://arxiv.org/abs/2107.01634)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Wyithe & Loeb (2008) Wyithe, S., & Loeb, A. 2008, Mon. Not. Roy. Astron. Soc.,
    383, 606, doi: [10.1111/j.1365-2966.2007.12568.x](http://doi.org/10.1111/j.1365-2966.2007.12568.x)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Wyithe et al. (2008) Wyithe, S., Loeb, A., & Geil, P. 2008, Mon. Not. Roy. Astron.
    Soc., 383, 1195, doi: [10.1111/j.1365-2966.2007.12631.x](http://doi.org/10.1111/j.1365-2966.2007.12631.x)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Çiçek et al. (2016) Çiçek, Ö., Abdulkadir, A., Lienkamp, S. S., Brox, T., &
    Ronneberger, O. 2016, arXiv e-prints, arXiv:1606.06650. [https://arxiv.org/abs/1606.06650](https://arxiv.org/abs/1606.06650)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
