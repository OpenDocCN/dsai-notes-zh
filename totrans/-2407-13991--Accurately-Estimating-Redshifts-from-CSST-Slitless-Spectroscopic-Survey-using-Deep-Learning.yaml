- en: <!--yml
  prefs: []
  type: TYPE_NORMAL
- en: 'category: 未分类'
  prefs: []
  type: TYPE_NORMAL
- en: 'date: 2024-09-06 19:31:11'
  prefs: []
  type: TYPE_NORMAL
- en: -->
  prefs: []
  type: TYPE_NORMAL
- en: '[2407.13991] Accurately Estimating Redshifts from CSST Slitless Spectroscopic
    Survey using Deep Learning'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 来源：[https://ar5iv.labs.arxiv.org/html/2407.13991](https://ar5iv.labs.arxiv.org/html/2407.13991)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Accurately Estimating Redshifts from CSST Slitless Spectroscopic Survey using
    Deep Learning
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Xingchen Zhou National Astronomical Observatories, Chinese Academy of Sciences,
    20A Datun Road, Beijing 100101, People’s Republic of China Science Center for
    China Space Station Telescope, National Astronomical Observatories, Chinese Academy
    of Sciences, 20A Datun Road, Beijing 100101, People’s Republic of China [Yan Gong](https://orcid.org/0000-0003-0709-0101)
    National Astronomical Observatories, Chinese Academy of Sciences, 20A Datun Road,
    Beijing 100101, People’s Republic of China University of Chinese Academy of Sciences,
    Beijing, 100049, People’s Republic of China Science Center for China Space Station
    Telescope, National Astronomical Observatories, Chinese Academy of Sciences, 20A
    Datun Road, Beijing 100101, People’s Republic of China Xin Zhang National Astronomical
    Observatories, Chinese Academy of Sciences, 20A Datun Road, Beijing 100101, People’s
    Republic of China Science Center for China Space Station Telescope, National Astronomical
    Observatories, Chinese Academy of Sciences, 20A Datun Road, Beijing 100101, People’s
    Republic of China Nan Li National Astronomical Observatories, Chinese Academy
    of Sciences, 20A Datun Road, Beijing 100101, People’s Republic of China Science
    Center for China Space Station Telescope, National Astronomical Observatories,
    Chinese Academy of Sciences, 20A Datun Road, Beijing 100101, People’s Republic
    of China Xian-Min Meng National Astronomical Observatories, Chinese Academy of
    Sciences, 20A Datun Road, Beijing 100101, People’s Republic of China Science Center
    for China Space Station Telescope, National Astronomical Observatories, Chinese
    Academy of Sciences, 20A Datun Road, Beijing 100101, People’s Republic of China
    Xuelei Chen National Astronomical Observatories, Chinese Academy of Sciences,
    20A Datun Road, Beijing 100101, People’s Republic of China Science Center for
    China Space Station Telescope, National Astronomical Observatories, Chinese Academy
    of Sciences, 20A Datun Road, Beijing 100101, People’s Republic of China Centre
    for High Energy Physiscs, Peking University, Beijing 100871, Peoples Republic
    of China Run Wen Purple Mountain Observatory, Chinese Academy of Sciences, 10
    Yuanhua Road, Nanjing 210023, People’s Republic of China School of Astronomy and
    Space Sciences, University of Science and Technology of China, Hefei, 230026,
    People’s Republic of China Yunkun Han Yunnan Observatories, Chinese Academy of
    Sciences, 396 Yangfangwang, Guandu District, Kunming 650216, People’s Republic
    of China Hu Zou National Astronomical Observatories, Chinese Academy of Sciences,
    20A Datun Road, Beijing 100101, People’s Republic of China Xian Zhong Zheng Purple
    Mountain Observatory, Chinese Academy of Sciences, 10 Yuanhua Road, Nanjing 210023,
    People’s Republic of China School of Astronomy and Space Sciences, University
    of Science and Technology of China, Hefei, 230026, People’s Republic of China
    Xiaohu Yang Department of Astronomy, School of Physics and Astronomy, Shanghai
    Jiao Tong University, Shanghai 200240, People’s Republic of China Tsung-Dao Lee
    Institute and Key Laboratory for Particle Physics, Astrophysics and Cosmology,
    Ministry of Education, Shanghai 201210, People’s Republic of China Hong Guo Shanghai
    Astronomical Observatory, Chinese Academy of Sciences, Shanghai 200030, People’s
    Republic of China Pengjie Zhang Department of Astronomy, School of Physics and
    Astronomy, Shanghai Jiao Tong University, Shanghai 200240, People’s Republic of
    China Tsung-Dao Lee Institute and Key Laboratory for Particle Physics, Astrophysics
    and Cosmology, Ministry of Education, Shanghai 201210, People’s Republic of China
  prefs: []
  type: TYPE_NORMAL
- en: Abstract
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: China Space Station Telescope (CSST) has the capability to conduct slitless
    spectroscopic survey simultaneously with photometric survey. The spectroscopic
    survey will measure slitless spectra, potentially providing more accurate estimations
    of galaxy properties, particularly redshift, compared to broadband photometry.
    However, due to low-resolution and signal-to-noise ratio of slitless spectra,
    measurement of these properties is significantly challenging. In this study, we
    employ a Bayesian neural network (BNN) to assess the accuracy of redshift estimations
    from slitless spectra anticipated to be observed by CSST. The slitless spectra
    are simulated based on real data from the early data release of the Dark Energy
    Spectroscopic Instrument (DESI-EDR) and the 16th data release of the Baryon Oscillaton
    Spectroscopic Survey (BOSS-DR16), combining the 9th data release of the DESI Legacy
    Survey (DESI LS DR9). The BNN provides redshifts estimates along with corresponding
    uncertainties, achieving an accuracy of $\sigma_{\rm NMAD}=0.00063$, outlier percentage
    $\eta=0.92\%$ and weighted mean uncertainty $\overline{E}=0.00228$. These results
    successfully meet the requirement for cosmological studies using slitless spectra
    from CSST.
  prefs: []
  type: TYPE_NORMAL
- en: 'galaxies: distances and redshifts — cosmology: observations — techniques: spectroscopic'
  prefs: []
  type: TYPE_NORMAL
- en: 1 Introduction
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Redshifts are one of the fundamental quantities for studying galaxies. The
    most accurate redshifts are determined through observing and analyzing high-resolution
    spectra from galaixes. However, obtaining high-resolution spectra is a time-consuming
    task, especially for high-redshift and faint sources, which require hours of observation
    to successfully measure their redshifts. As a result, photometric redshifts, estimated
    from several photometric mesurements, become a necessary option for most sources
    observed in ongoing and future cosmological surveys. However, the large error
    of $\gtrsim 0.02$ associated with photometric redshifts severely hinders certain
    cosmological studies using techniques such as baryon acoustic oscillation (BAO,
     Bassett & Hlozek ([2010](#bib.bib4))) and redshift-space distortions (RSD,  Hamilton
    ([1998](#bib.bib18))). To match the accuracy required by these cosmological studies
    and the survey speed of current photometric surveys, a compromise solution exists:
    slitless spectra. Slitless spectra represent a category of low-resolution spectroscopy
    performed without a narrow slit, which typically allows only light from a small
    region to be diffracted. Current and future photometric surveys, such as Euclid
    Space Telescope (Euclid,  Euclid Collaboration et al. ([2024](#bib.bib13))), James
    Webb Space Telescope (JWST,  Sabelhaus & Decker ([2004](#bib.bib42))), Nancy Grace
    Roman Space Telescope (Roman) ¹¹1[https://roman.gsfc.nasa.gov/](https://roman.gsfc.nasa.gov/)
    and China Space Station Telescope (CSST,  Zhan ([2018](#bib.bib50)); Gong et al.
    ([2019](#bib.bib16))), all include modules to observe slitless spectra for galaxies.'
  prefs: []
  type: TYPE_NORMAL
- en: CSST is a 2-meter space telescope designed for photometric observations across
    seven bands, ranging from near-ultraviolet to near-infrared. The slitless spectroscopy
    module, which include three bands ($GU$, $GV$ and $GI$), operates alongside the
    photometric module, enabling simultaneous photometric and slitless spectroscopic
    observations. These three bands can reach 5$\sigma$ magnitude limit of 23.2, 23.4
    and 23.2 for point sources, respectively, with a low spectroscopic resolution
    of each band as $R=\lambda/\Delta\lambda\geq 200$ (Gong et al., [2019](#bib.bib16)).
    For extended sources such as galaxies, slitless spectra can be significantly affected
    by observational and instrumental effects, challenging the one-dimensional spectrum
    extraction procedure and thus resulting in low-resolution and signal-to-noise
    ratio (SNR) spectra. These challenges make the recognition of emission and absorption
    lines, breaks, and other spectroscopic features difficult. As a result, galaxy
    properties such as redshift and line fluxes estimated from these spectra can be
    highly inaccurate, leading to errors comparable to those derived from broadband
    photometry. Addressing the challenge of successfully measuring these galaxy properties
    from such low-resolution and SNR slitless spectra remains an urgent problem.
  prefs: []
  type: TYPE_NORMAL
- en: Machine Learning (ML), particularly Deep Learning (DL) algorithms (also know
    as neural networks), offers a potential solution to the challenges posed by noisy
    data. This algorithm can effectively learn the inherent correlations between inputs
    and outputs using large datasets, making them well-suited to handle data significantly
    affected by instrumental or other forms of noise. In the astronomical and cosmological
    communities, neural networks have gained prominence in recent years, achieving
    applications across various fields. The multilayer perceptron (MLP), a simple
    neural network, has been applied to estimate photometric redshifts from multi-band
    photometric measurements (Collister & Lahav, [2004](#bib.bib7); Sadeh, [2014](#bib.bib43);
    Zhou et al., [2022a](#bib.bib52)), surpassing the accuracy achieved by traditional
    spectral energy distribution (SED) fitting methods.
  prefs: []
  type: TYPE_NORMAL
- en: Furthermore, state-of-the-art convolutional neural networks (CNN,  Lecun et al.
    ([1998](#bib.bib29))), which excel in directly processing images, have become
    indispensable in astronomical and cosmological analysis. Applications include
    deriving photometric redshifts or other quantities from galaxy images (Pasquet
    et al., [2019](#bib.bib37); Henghes et al., [2022](#bib.bib21); Zhou et al., [2022a](#bib.bib52);
    Tewes et al., [2019](#bib.bib48); Zhang et al., [2024](#bib.bib51)), discovering
    strong lensing systems or mergers (He et al., [2020](#bib.bib20); Schaefer et al.,
    [2018](#bib.bib44); Li et al., [2020](#bib.bib30); Rezaei et al., [2022](#bib.bib41);
    Pearson et al., [2019](#bib.bib38); Arendt et al., [2024](#bib.bib3)), and constraining
    cosmological parameters from large-scale structures or weak gravitational lensing (Pan
    et al., [2020](#bib.bib36); Min et al., [2024](#bib.bib35); Hortúa et al., [2023](#bib.bib22);
    Gupta et al., [2018](#bib.bib17); Fluri et al., [2022](#bib.bib14)).
  prefs: []
  type: TYPE_NORMAL
- en: In addition to processing 2-dimensional arrays, CNNs can be adapted to handle
    1-dimensional sequences or 3-dimensional data cubes. Spectra are 1-dimensional
    sequences containing redshift or other information, which can be effectively extracted
    by 1d-CNNs. The application of 1d-CNNs for deriving redshifts from spectra is
    extensively researched (Rastegarnia et al., [2022](#bib.bib40); Busca & Balland,
    [2018](#bib.bib6)).
  prefs: []
  type: TYPE_NORMAL
- en: Unlike traditional fitting methods that produce both redshifts and uncertainties,
    deep learning methods typically provide only redshift values. Recognizing the
    importance of uncertainties in cosmological studies, Bayesian neural networks
    (BNN) (MacKay, [1995](#bib.bib33); Blundell et al., [2015](#bib.bib5); Gal & Ghahramani,
    [2015](#bib.bib15)), which can output both point estimations and uncertainties,
    have gained significant attention. By assigning probability distributions to each
    weight in the network, BNNs can capture and propagate uncertainties from data
    and neural network itself to the output, providing not only point predictions
    but also confidence intervals or posterior distributions.
  prefs: []
  type: TYPE_NORMAL
- en: Although deep learning algorithm offers advantages in providing better accuracy,
    higher speed, and direct processing of raw data, several challenges need careful
    consideration. Since deep learning models heavily rely on training data, obtaining
    abundant and representative data for observation is a primary concern. Specifically,
    for redshift estimation, a large dataset with high-quality spectroscopic redshifts
    is essential. Fortunately, several ongoing and planned spetroscopic surveys, such
    as the Dark Energy Spectroscopic Instrument (DESI, DESI Collaboration et al. ([2016](#bib.bib9))),
    Prime Focus Spectrograph (PFS,  Tamura et al. ([2016](#bib.bib47))), MUltiplexed
    Spectroscopic Telescope (MUST) ²²2[https://must.astro.tsinghua.edu.cn/en](https://must.astro.tsinghua.edu.cn/en),
    MegaMapper (Schlegel et al., [2022](#bib.bib45)) and Wide-field Spectroscopic
    Telescope (WST, Mainieri et al. ([2024](#bib.bib34))), aim to observe a substantial
    number of galaxy spectra with accurate redshifts. Including completed surveys
    like zCOSMOS (Lilly et al., [2007](#bib.bib31)), VIMOS-VLT Deep Survey (VVDS,
    Le Fevre et al. ([2013](#bib.bib28))), Sloan Digital Sky Survey (SDSS,  Ahumada
    et al. ([2020](#bib.bib2))), Baryon Oscillation Spectroscopic Survey (BOSS,  Dawson
    et al. ([2013](#bib.bib8))), a sufficient and representative training set for
    redshift estimation can be achieved.
  prefs: []
  type: TYPE_NORMAL
- en: In this work, we generate sliltess spectra expected to be observed by CSST based
    on real spectroscopic observations. Considering the redshift coverage and survey
    fields, we employ data from DESI early data release (DESI-EDR, DESI Collaboration
    et al. ([2023](#bib.bib10))) and BOSS 16th data release (BOSS-DR16, Dawson et al.
    ([2013](#bib.bib8))). DESI-EDR has made available 1.2 million high-resolution
    spectra of galaxies and quasars collected during the Survey Validation (SV) phase
    for target selections. Since the number of sources in DESI-EDR are limited, we
    supplement our slitless spectrum dataset with BOSS data, which shares a similar
    pipeline for the measurement of spectroscopic redshifts, to increase the data
    size for training the neural network model. After obtaining the slitless spectra,
    we train a 1d-BNN with these spectra and their corresponding accurate spectroscopic
    redshifts, and then analyze the redshift accuracy that can be achieved for CSST
    slitless spectroscopic survey.
  prefs: []
  type: TYPE_NORMAL
- en: 'The structure of this paper is organized as follows: we briefly describe CSST
    slitless spectra simulation software and then explain the generation of the mock
    slitless spectra in Section [2](#S2 "2 Mock Data ‣ Accurately Estimating Redshifts
    from CSST Slitless Spectroscopic Survey using Deep Learning"). And the neural
    network methods including CNN and BNN are introduced in Section [3](#S3 "3 Methodology
    ‣ Accurately Estimating Redshifts from CSST Slitless Spectroscopic Survey using
    Deep Learning"). Then we demonstrate our results in Section [4](#S4 "4 Results
    ‣ Accurately Estimating Redshifts from CSST Slitless Spectroscopic Survey using
    Deep Learning"). Finally, this paper is concluded in Section [5](#S5 "5 Conclusion
    ‣ Accurately Estimating Redshifts from CSST Slitless Spectroscopic Survey using
    Deep Learning").'
  prefs: []
  type: TYPE_NORMAL
- en: 2 Mock Data
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In this section, we firstly introduce the slitless spectra simulation software
    in CSST data analysis pipeline, and then explain the data generation procedure
    of slitless spectra using this software from real spectroscopic observations.
  prefs: []
  type: TYPE_NORMAL
- en: 2.1 Slitless spectra simulation software
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The simulation software for slitless spectra is an integral part of the CSST
    data analysis pipeline, with the code available online³³3[https://csst-tb.bao.ac.cn/code/zhangxin/sls_1d_spec](https://csst-tb.bao.ac.cn/code/zhangxin/sls_1d_spec).
    We provide a brief overview of the workflow here, and interested readers are recommended
    to consult Zhang et al. (in preparation) for detailed information. This software
    utilizes spectral energy distributions (SEDs) and morphological parameters of
    galaxies to generate mock spectra. Initially, the dispersion curve for the grating
    is determined through a fitting process that considers the spectroscopic properties
    of the CSST’s slitless spectrum. Following this, the energy profile of the galaxy,
    which is contingent upon its morphological parameters, is converted into a pixelated
    galaxy image. Each pixel of the galaxy image undergoes dispersion based on the
    dispersion curve specific to the CSST grating, in conjunction with the sensitivity
    curve of the CSST instrument and the galaxy’s SED. Finaly, all dispersed components
    are integrated into a two-dimensional slitless spectral image. Additionally, instrumental
    effects are simulated using a point spread function (PSF), assumed to be 2D Gaussian
    distribution with a full width at half maximum (FWHM) of 0.3^(′′). The sky backgrounds,
    including zodiacal and earthshine components, are computed as 0.019, 0.214, 0.329
    $\rm e^{-}s^{-1}pixel^{-1}$ for the $GU$, $GV$ and $GI$ bands respectively. To
    mitigate the effects of instrumental and background noise, we co-add spectra from
    four exposures, each with a duration of 150 seconds. Following these procedures,
    we generate first-order spectral images expected to be observed by CSST, from
    which we can extract the 1d-spectra and the corresponding errors.
  prefs: []
  type: TYPE_NORMAL
- en: 2.2 Data generation
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: To realistically simulate our slitless spectra, we utilize spectroscopic observations
    from the Dark Energy Spectroscopic Instrument (DESI) and the Baryon Oscillation
    Spectroscopic Survey (BOSS). DESI is an ongoing spectroscopic survey conducted
    on the Mayall 4-meter telescope at Kitt Peak National Observatory. Over its 5-year
    mission, DESI aims to observe spectra for more than 30 million galaxies and quasars
    across 14,000 square degrees of sky (DESI Collaboration et al., [2016](#bib.bib9)).
    Recently, DESI has released its Early Data Release (EDR), which includes spectroscopic
    data for 1.8 million targets observed during the Survey Validation (SV) phase
    conducted from December 2020 to June 2021 (DESI Collaboration et al., [2023](#bib.bib10)).
  prefs: []
  type: TYPE_NORMAL
- en: 'We select sources from the EDR spectroscopic redshift catalogue using the following
    criteria:'
  prefs: []
  type: TYPE_NORMAL
- en: '|  |  | $\displaystyle\rm SV\_PRIMARY==True$ |  | (1) |'
  prefs: []
  type: TYPE_TB
- en: '|  |  | $\displaystyle\rm MASKBITS==0$ |  |'
  prefs: []
  type: TYPE_TB
- en: '|  |  | $\displaystyle\rm SPECTYPE==GALAXY$ |  |'
  prefs: []
  type: TYPE_TB
- en: '|  |  | $\displaystyle\rm ZWARN==0$ |  |'
  prefs: []
  type: TYPE_TB
- en: '|  |  | $\displaystyle\rm FLUX\_G,R,Z>0$ |  |'
  prefs: []
  type: TYPE_TB
- en: '|  |  | $\displaystyle\rm FLUX\_IVAR\_G,R,Z>0$ |  |'
  prefs: []
  type: TYPE_TB
- en: '|  |  | $\displaystyle\rm MORPHTYPE\ !=PSF$ |  |'
  prefs: []
  type: TYPE_TB
- en: 'Here, SV_PRIMARY indicates the best recommended redshift if the same source
    appears multiple times in the catalogue, while MASKBITS is the bitwise mask indicating
    that the source touches a pixel in a masked area. SPECTYPE and ZWARN are source
    classification and indicators of potential issues in spectroscopic redshift measured
    by Redrock ⁴⁴4[https://github.com/desihub/redrock](https://github.com/desihub/redrock),
    a commonly used redshift fitting software. We further control the quality of sources
    by applying constraints on photometric measurements in the $g$, $r$ and $z$ bands
    of the DESI legacy imaging survey (Dey et al., [2019](#bib.bib11)). MORPHTYPE
    indicates the Tractor model used to fit the source during photometric measurement.
    This constraint ensures that the selected sources are extended, allowing for accurate
    morphological parameter measurements. It should be noted that some PSF sources
    are spectroscopically classified as galaxies. These PSF models are assigned probably
    due to the resolution of $\sim 1.0^{\prime\prime}$ in imaging data of DESI legacy
    survey, and we simply exclude these galaxies in our dataset. To obtain the morphological
    parameters required to derive our slitless spectra, we match the selected sources
    with the sweep catalogue of DESI legacy survey DR9 ⁵⁵5[https://www.legacysurvey.org/dr9/files/#sweep-catalogs-region-sweep](https://www.legacysurvey.org/dr9/files/#sweep-catalogs-region-sweep)
    and retrieve the morphological parameters, including effective radius $r_{\rm
    eff}$, sersic index $n$, two ellipticity components $\epsilon_{1},\epsilon_{2}$
    and their variance. And we perform another selection to filter the sources with
    valid morphological measurements:'
  prefs: []
  type: TYPE_NORMAL
- en: '|  |  | $\displaystyle\rm SHAPE\_R>0$ |  | (2) |'
  prefs: []
  type: TYPE_TB
- en: '|  |  | $\displaystyle\rm SHAPE\_IVAR\_R>0$ |  |'
  prefs: []
  type: TYPE_TB
- en: '|  |  | $\displaystyle\rm SHAPE\_E1\_IVAR>0$ |  |'
  prefs: []
  type: TYPE_TB
- en: '|  |  | $\displaystyle\rm SHAPE\_E2\_IVAR>0$ |  |'
  prefs: []
  type: TYPE_TB
- en: '|  |  | $\displaystyle\rm SERSIC\_IVAR>0$ |  |'
  prefs: []
  type: TYPE_TB
- en: 'and then we calculate the axis ratio $b/a$ and position angle $\phi$ using
    the following equations as recommended by DESI:'
  prefs: []
  type: TYPE_NORMAL
- en: '|  | $\displaystyle&#124;\epsilon&#124;=\sqrt{\epsilon_{1}^{2}+\epsilon_{2}^{2}},$
    |  | (3) |'
  prefs: []
  type: TYPE_TB
- en: '|  | $\displaystyle\frac{b}{a}=\frac{1-&#124;\epsilon&#124;}{1+&#124;\epsilon&#124;},$
    |  |'
  prefs: []
  type: TYPE_TB
- en: '|  | $\displaystyle\phi=\frac{1}{2}\arctan{\frac{\epsilon_{2}}{\epsilon_{1}}}.$
    |  |'
  prefs: []
  type: TYPE_TB
- en: This selection process results in approximately 180,000 sources with high-quality
    spectroscopic redshifts. Note that we admit that the morphological parameters
    of some sources have large errors, exerting significant effects on simulated slitless
    spectra. However, these effects are ignored in this work since our aim is to estimate
    redshifts and the relation between the spectra and redshifts is well-determined
    regardless of the morphological errors.
  prefs: []
  type: TYPE_NORMAL
- en: After obtaining the redshifts and morphological parameters, the next step involves
    acquiring the spectral energy distribution (SED) for each source to simulate slitless
    spectra. The spectroscopic redshifts of the sources have been determined using
    model spectra fitted by Redrock, and all redshift warning flags are zero, indicating
    no issues with the fitting process. This allows us to use the model spectra to
    accurately represent the SED of each source. These model spectra can be constructed
    using the COEFF provided in the DESI-EDR catalogue, combining Redrock templates,
    or accessed via the SPectra Analysis & Retrievable Catalog Lab (SPARCL) ⁶⁶6[https://astrosparcl.datalab.noirlab.edu/](https://astrosparcl.datalab.noirlab.edu/).
    The model spectra obtained through both approaches are the same, and we choose
    the latter.
  prefs: []
  type: TYPE_NORMAL
- en: The 180,000 sources selected from DESI-EDR are insufficient for training our
    neural network to derive redshifts from low-quality slitless spectra. To supplement
    our dataset, we utilize data from the Baryon Oscillation Spectroscopic Survey
    (BOSS). BOSS is a spectroscopic survey primarily targeting luminous red galaxies
    (LRGs) up to $z\sim 0.7$ and quasars (QSOs) at redshifts $2.2<z<3$, aimed at detecting
    the characteristic scale imprinted by baryon acoustic oscillations (BAO) in the
    early Universe. Over its 5-year observation period, BOSS has measured spectra
    for approximately 4 million sources, covering 10,000 square degrees (Dawson et al.,
    [2013](#bib.bib8)). For this work, we use 16th data release from BOSS (BOSS-DR16).
  prefs: []
  type: TYPE_NORMAL
- en: Similar to our approach with DESI data, we select galaxies with a spectroscopic
    redshift warning ZWARN == 0, produced by Redrock software, and match these sources
    with the DESI LS DR9\. We exclude sources modeled as PSF and without reasonable
    photometric measurements in the $g$, $r$ and $z$ bands and those lacking valid
    morphological parameters. This results in a selection of 450,000 galaxies, for
    which we download their model spectra using SPARCL. In total, we obtain approximately
    600,000 sources.
  prefs: []
  type: TYPE_NORMAL
- en: The spectroscopic redshift distributions are illustrated in Figure [1](#S2.F1
    "Figure 1 ‣ 2.2 Data generation ‣ 2 Mock Data ‣ Accurately Estimating Redshifts
    from CSST Slitless Spectroscopic Survey using Deep Learning"). We notice that
    most sources from DESI-EDR are at low redshifts, while high redshift sources up
    to $z\sim 1$ are supplemented by BOSS-DR16\. The distribution of morphological
    parameters, including effective radius $r_{\rm eff}$, sersic index $n$, axis ratio
    $b/a$ and position angle $\phi$ are illustrated in Figure [2](#S2.F2 "Figure 2
    ‣ 2.2 Data generation ‣ 2 Mock Data ‣ Accurately Estimating Redshifts from CSST
    Slitless Spectroscopic Survey using Deep Learning"). Notably, galaxies with a
    Sersic index of 6 dominate, particularly those from BOSS-DR16\. This selection
    bias is as expected, as the Sersic index positively correlates with galaxy size
    and luminosity. Hence, for valid morphological measurements and accurate spectroscopic
    redshift extraction, the sources tend to be larger in size and brighter in luminosity.
  prefs: []
  type: TYPE_NORMAL
- en: '![Refer to caption](img/c7b971f34b387b7d6a441c3346da6ce5.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 1: Spectroscopic redshift distributions for selected sources in DESI-EDR,
    BOSS-DR16 and total.'
  prefs: []
  type: TYPE_NORMAL
- en: After obtaining the model spectra and morphological parameters for sources in
    DESI-EDR and BOSS-DR16, we simulate the slitless spectra using the simulation
    software mentioned in Section [2.1](#S2.SS1 "2.1 Slitless spectra simulation software
    ‣ 2 Mock Data ‣ Accurately Estimating Redshifts from CSST Slitless Spectroscopic
    Survey using Deep Learning"). The signal-to-noise ratio (SNR) of the simulated
    CSST slitless spectra in $GU$, $GV$, $GI$ and total are illustrated in Figure [3](#S2.F3
    "Figure 3 ‣ 2.2 Data generation ‣ 2 Mock Data ‣ Accurately Estimating Redshifts
    from CSST Slitless Spectroscopic Survey using Deep Learning"). We notice that
    the SNRs of $GI$ are the best reaching a peak at about $2$, while most SNRs of
    $GU$ and $GV$ bands are lower than $1$. Additionally, the total SNRs of these
    spectra peak at $\sim 1$, indicating signal and noise are at similar level. In
    Figure [4](#S2.F4 "Figure 4 ‣ 2.2 Data generation ‣ 2 Mock Data ‣ Accurately Estimating
    Redshifts from CSST Slitless Spectroscopic Survey using Deep Learning"), we display
    two examples of simulated first-order slitless spectral images in $GU$, $GV$ and
    $GI$ bands, and the corresponding extracted one-dimensional spectra are shown
    in Figure [5](#S2.F5 "Figure 5 ‣ 2.2 Data generation ‣ 2 Mock Data ‣ Accurately
    Estimating Redshifts from CSST Slitless Spectroscopic Survey using Deep Learning").
    The SEDs used in simulation are also illustrated and they are in consistency with
    the spectra. Additionally, the source information including coordinates (R.A.
    and Dec.), spectroscopic redshifts, morphological parameters used in simulation
    and SNR in $GU$, $GV$ and $GI$ band are also shown. For the low-redshift source
    in the left panel, we can clearly recognize the dispersed 2d-spectra in $GV$ and
    $GI$ bands, and SNRs of the extracted 1d-spectra in these two bands are relatively
    high. While for high-redshift source in the right panel, only a faint 2d-spectra
    in $GI$ band can be recognized, with the other two bands are dominated by noise,
    hence the extracted 1d-spectra are correspondingly with low SNR. Overall, the
    slitless spectra are severely affected by background and instrumental noise and
    the recognition of spectroscopic features such as break, absorption and emission
    lines is difficult, leading to challenges for successful redshift determinations
    using traditional approaches such as spectrum fitting or feature identification.
  prefs: []
  type: TYPE_NORMAL
- en: '![Refer to caption](img/9eb40947f103c8bf2dc7577745182b38.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 2: The distribution of four morphological parameters: effective radius
    $r_{\rm eff}$, sersic index $n$, axis ratio $b/a$ and position angle $\phi$ of
    sources from DESI-EDR and BOSS-DR16.'
  prefs: []
  type: TYPE_NORMAL
- en: '![Refer to caption](img/4eceb51dad143405168f7be997428112.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 3: The SNR distributions of simulated slitless spectra in $GU$, $GV$,
    $GI$ bands and over the whole wavelength.'
  prefs: []
  type: TYPE_NORMAL
- en: '![Refer to caption](img/56ed7837b893daa5f2a5d71ab30a508b.png)![Refer to caption](img/80f3d22d6bf57727ffc07c8817161166.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 4: Two examples of simulated first-order slitless spectral images in
    $GU$, $GV$ and $GI$ bands. The coordinates and spectroscopic redshifts are also
    shown. And the corresponding extracted one-dimensional spectra and more information
    of the two sources are displayed in Figure [5](#S2.F5 "Figure 5 ‣ 2.2 Data generation
    ‣ 2 Mock Data ‣ Accurately Estimating Redshifts from CSST Slitless Spectroscopic
    Survey using Deep Learning").'
  prefs: []
  type: TYPE_NORMAL
- en: '![Refer to caption](img/a0f5becf902aca52d7d887bec825f839.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 5: The corresponding one-dimensional spectra extracted from spectral
    images of sources in Figure [4](#S2.F4 "Figure 4 ‣ 2.2 Data generation ‣ 2 Mock
    Data ‣ Accurately Estimating Redshifts from CSST Slitless Spectroscopic Survey
    using Deep Learning"). The SEDs used in simulation are also illustrated. And the
    black dash-dotted line indicates zero fluxes. Additionaly, the source information
    including coordinates, spectroscopic redshifts, morphological parameters and SNR
    of each band are also shown.'
  prefs: []
  type: TYPE_NORMAL
- en: 3 Methodology
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We employ deep neural network to extract redshifts from slitless spectra expected
    to be observed by CSST. To satisfy the requirement of some cosmological studies,
    we further construct Bayesian neural network to derive redshift values along with
    their uncertainties.
  prefs: []
  type: TYPE_NORMAL
- en: 3.1 Neural networks
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '![Refer to caption](img/0b772a07c3a208cabfade46c9393d828.png)![Refer to caption](img/062a58302206099e73ee7f6d5f30a3b0.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 6: Left: The architecture of the 1d-CNN and BNN built upon ResNet blocks.
    Right: The structure of the ResNet block.'
  prefs: []
  type: TYPE_NORMAL
- en: Since spectra are 1-dimensional sequences, we employ 1d-CNN to process them.
    CNN is a powerful deep learning model which can learn the internal connections
    between data and labels. Therefore, we expect that our 1d-CNN can learn the mapping
    between slitless spectra and redshifts. To improve its learning ability, we increase
    the depth of our 1d-CNN using ResNet blocks (He et al., [2015](#bib.bib19)). This
    block can effectively reduce the vanishing gradient problem commonly happened
    in deep neural networks through skip connections, as illustrated in the right
    panel of Figure [6](#S3.F6 "Figure 6 ‣ 3.1 Neural networks ‣ 3 Methodology ‣ Accurately
    Estimating Redshifts from CSST Slitless Spectroscopic Survey using Deep Learning").
    The convolutional layer in skip connection is applied when this block process
    and downsample the features at the same time. Following Zhou et al. ([2021](#bib.bib54)),
    the input to our CNN includes spectra and corresponding errors as a two-channel
    sequences. And then the inputs are processed by one convolutional layer with 32
    kernels with kernel size of 7, followed by a max-pooling to reduce the feature
    dimension. After this shallow feature extraction layers, we structure 8 ResNet
    blocks to obtain useful features from spectra and further reduce the feature dimension.
    The 1d convolutional layers in these blocks are all followed by BatchNormalization
    layers (Ioffe & Szegedy, [2015](#bib.bib24)) to reduce overfitting. And ReLU activation
    functions (Agarap, [2018](#bib.bib1)) are structured to apply non-linearity. Subsequently,
    the features are vectorized to one-dimension using global average pooling, and
    then a dropout layer (Srivastava et al., [2014](#bib.bib46)) with drop rate of
    0.2 is applied. This dropout layer also functions as overfitting reduction. Finally,
    the output layer with one neuron is structured. The illustration of architecture
    is displayed in the left panel of Figure [6](#S3.F6 "Figure 6 ‣ 3.1 Neural networks
    ‣ 3 Methodology ‣ Accurately Estimating Redshifts from CSST Slitless Spectroscopic
    Survey using Deep Learning").
  prefs: []
  type: TYPE_NORMAL
- en: The neural network mentioned yet can only output redshift value. In order to
    output redshifts along with their uncertainties, we construct a Bayesian neural
    network that captures both the epistemic and aleatoric uncertainties arise from
    neural network model and dataset respectively. For more details about this network,
    please refer to Hortúa et al. ([2020](#bib.bib23)) and  Zhou et al. ([2022b](#bib.bib53)).
    Our BNN is built using transfer learning technique to transfer the feature extraction
    part before the final output layer of CNN and then append two Bayesian layers.
    The weights from the transferred network are set as fixed, leveraging the features
    that are tailored to derive the redshift. For Bayesian layers, three common configurations
    are widely employed, i.e. Monte-Carlo dropout (MC-dropout,  Gal & Ghahramani ([2015](#bib.bib15))),
    flipout (Wen et al., [2018](#bib.bib49)), and Multiplicative Normalizing Flows
    (MNF,  Louizos & Welling ([2017](#bib.bib32))) layer. Among these three categories,
    MC-dropout uses dropout to simulate varying structures of network, while the weights
    in flipout and MNF layers are represented by distributions. Particularly, MNF
    employs more complicated distributions transformed through Gaussian distribution
    using normalizing flows (Jimenez Rezende & Mohamed, [2015](#bib.bib25)). As recommended
    in Zhou et al. (in preparation), we adopt MNFDense layers ⁷⁷7[https://github.com/janosh/tf-mnf](https://github.com/janosh/tf-mnf)
    adapting 50 layers for masked RealNVP normalizing flow (Dinh et al., [2016](#bib.bib12)).
    Finally, the network outputs two values, from which a Gaussian distribution representing
    the distribution of redshift can be derived. The illustration of architecture
    is also displayed in the left panel of Figure [6](#S3.F6 "Figure 6 ‣ 3.1 Neural
    networks ‣ 3 Methodology ‣ Accurately Estimating Redshifts from CSST Slitless
    Spectroscopic Survey using Deep Learning").
  prefs: []
  type: TYPE_NORMAL
- en: The uncertainties produced by Bayesian network must follow statistical principles
    that the coverage probabilities of the sample with true value within specific
    confidence intervals match the corresponding confidence intervals (Perreault Levasseur
    et al., [2017](#bib.bib39); Hortúa et al., [2020](#bib.bib23)), otherwise, calibration
    is a necessary procedure before reporting the results. Here we employ Beta calibration
    technique mentioned in Kull et al. ([2017](#bib.bib27)) to calibrate the uncertainties.
  prefs: []
  type: TYPE_NORMAL
- en: 3.2 Training
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: We only consider the spectra in $GV$ and $GI$ bands, since the SNRs in $GU$
    band are significantly low and the spectra are dominated by noise as shown in
    Figure [3](#S2.F3 "Figure 3 ‣ 2.2 Data generation ‣ 2 Mock Data ‣ Accurately Estimating
    Redshifts from CSST Slitless Spectroscopic Survey using Deep Learning") and Figure [4](#S2.F4
    "Figure 4 ‣ 2.2 Data generation ‣ 2 Mock Data ‣ Accurately Estimating Redshifts
    from CSST Slitless Spectroscopic Survey using Deep Learning"). Before training,
    our data are split into training, validation and testing sets as a ratio of 8:1:1\.
    The number of testing set is approximately 60,000 and they are selected based
    on the expected redshift distribution of CSST slitless spectroscopic survey. The
    redshift distribution of the testing set is displayed in Figure [8](#S4.F8 "Figure
    8 ‣ 4 Results ‣ Accurately Estimating Redshifts from CSST Slitless Spectroscopic
    Survey using Deep Learning"), and is consistent with the one shown in Gong et al.
    ([2019](#bib.bib16)). To improve the performance of neural network, we follow
    the methodology in Zhou et al. ([2021](#bib.bib54)) to increase the size of training
    set by involving their Gaussian realization counterparts created through fluctuating
    the spectra based on the their corresponding errors. This data augmentation technique
    can effectively amplify the adaptability of network to the large noise in low-SNR
    siltless spectra. Here we use 50 random realizations. For 1d-CNN, we set loss
    function and optimizer as logcosh and Adam. Logcosh resembles traditional mean-absolute-error
    function but with a differential behavior around 0, and Adam is a stochastic gradient
    descent optimization method based on adaptive estimate of first-order and second-order
    moments (Kingma & Ba, [2014](#bib.bib26)). This network is trained for 100 epochs
    with batch size of 1024 considering the graphic memory of GPU, and we select the
    best model with lowest loss value as our final CNN model and the backbone for
    BNN.
  prefs: []
  type: TYPE_NORMAL
- en: For BNN, only the weights of appended MNF layers are optimized in training.
    The loss function of BNN is set to be negative log-likelihood (NLL), different
    from the one employed in CNN, since BNN outputs a distribution considering both
    point values and their uncertainties. Note that the labels are solely redshift
    values, since the uncertainties are naturally derived during the decrease of the
    loss function. Similarly, we adopt the Adam optimizer and save the model with
    lowest loss value. Different from the CNN in post processing, we feed the testing
    spectra to the BNN for 200 times. Based on these outputs, we calculate the final
    redshift values and their corresponding uncertainties which account for both epistemic
    and aleatoric ones.
  prefs: []
  type: TYPE_NORMAL
- en: 4 Results
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'We employ two metrics to evaluate the performance of CNN: outlier percentage
    $\eta$ and normalized median absolute deviation $\sigma_{\rm NMAD}$, defined as
    follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '|  | $\eta=\frac{N_{\Delta z/(1+z_{\rm true})>0.02}}{N_{\rm total}},$ |  |
    (4) |'
  prefs: []
  type: TYPE_TB
- en: '|  | $\sigma_{\rm NMAD}=1.48\times{\rm median}\left(\left&#124;\frac{\Delta
    z-{\rm median}(\Delta z)}{1+z_{\rm true}}\right&#124;\right),$ |  | (5) |'
  prefs: []
  type: TYPE_TB
- en: where $\Delta z=z_{\rm pred}-z_{\rm true}$, with $z_{\rm pred}$ and $z_{\rm
    true}$ indicating the predictions and true redshifts respectively. $\eta$ demonstrates
    the fraction of severely inaccurate redshift predictions, and $\sigma_{\rm NMAD}$
    is a robust accuracy metric that is not highly affected by the outliers.
  prefs: []
  type: TYPE_NORMAL
- en: Figure [7](#S4.F7 "Figure 7 ‣ 4 Results ‣ Accurately Estimating Redshifts from
    CSST Slitless Spectroscopic Survey using Deep Learning") illustrates the results
    for CNN. The accuracy $\sigma_{\rm NMAD}$ and outlier percentage $\eta$ can reach
    0.00047 and 0.954% respectively. The accuracy metric successfully meets the $\sim
    0.2\%$ requirement of cosmological studies for CSST. The logarithmic SNR of $GI$
    bands are also displayed by colorbar. We notice that as expected, the SNR decreases
    with respect to redshift and most outliers have relatively low SNR. The redshift
    distribution is displayed in Figure [8](#S4.F8 "Figure 8 ‣ 4 Results ‣ Accurately
    Estimating Redshifts from CSST Slitless Spectroscopic Survey using Deep Learning"),
    and is in high consistency with true distribution. Furthermore, Figure [9](#S4.F9
    "Figure 9 ‣ 4 Results ‣ Accurately Estimating Redshifts from CSST Slitless Spectroscopic
    Survey using Deep Learning") displays the accuracy and outlier percentage with
    respect to true redshifts in the upper and lower panel respectively. The two metrics
    over whole redshift range are also displayed in black dashed lines. As expected,
    both metrics remain steady at lower redshift and becomes worse at higher redshift.
  prefs: []
  type: TYPE_NORMAL
- en: 'As for the results from BNN, apart from the two metrics mentioned above, we
    employ another metric to measure the performance of uncertainty predictions, i.e.
    weighted mean uncertainty $\overline{E}$, which is defined as:'
  prefs: []
  type: TYPE_NORMAL
- en: '|  | $\overline{E}=\frac{\sum_{i}E_{i}/(1+z_{i,\rm{true}})}{N_{\rm total}},$
    |  | (6) |'
  prefs: []
  type: TYPE_TB
- en: where $E_{i}$ is the uncertainty prediction for each source. The weight $1+z_{i,\rm
    true}$ applied to each source is to eliminate the bias from the evolution of redshifts.
    The Figure [10](#S4.F10 "Figure 10 ‣ 4 Results ‣ Accurately Estimating Redshifts
    from CSST Slitless Spectroscopic Survey using Deep Learning") displays the reliability
    diagram for uncertainty predictions. After Beta calibration, the uncertainties
    better follow the statistical principle as mentioned in Section [3.1](#S3.SS1
    "3.1 Neural networks ‣ 3 Methodology ‣ Accurately Estimating Redshifts from CSST
    Slitless Spectroscopic Survey using Deep Learning"). And Figure [11](#S4.F11 "Figure
    11 ‣ 4 Results ‣ Accurately Estimating Redshifts from CSST Slitless Spectroscopic
    Survey using Deep Learning") shows the results after uncertainty calibration,
    where the errorbars are displayed in lightblue. $\sigma_{\rm NMAD}$ and $\eta$
    can achieve 0.00063 and 0.92% respectively. And $\eta$ slightly improves compared
    to point estimates illustrated in Figure [7](#S4.F7 "Figure 7 ‣ 4 Results ‣ Accurately
    Estimating Redshifts from CSST Slitless Spectroscopic Survey using Deep Learning"),
    while the accuracy becomes a little worse, but still meet the requirement of cosmological
    studies. Furthermore, the weighed mean uncertainty $\overline{E}$ can reach 0.00228\.
    The redshift distribution is displayed in Figure [8](#S4.F8 "Figure 8 ‣ 4 Results
    ‣ Accurately Estimating Redshifts from CSST Slitless Spectroscopic Survey using
    Deep Learning"), and similarly is in high consistency with true distribution.
    Figure [12](#S4.F12 "Figure 12 ‣ 4 Results ‣ Accurately Estimating Redshifts from
    CSST Slitless Spectroscopic Survey using Deep Learning") further analyze the behavior
    of uncertainties. The upper panel displays the weighted mean uncertainty $\overline{E}$
    with respect to true redshift, in which the black dashed line shows the value
    over the whole redshift range. As expected, this metric similarly remains stable
    at lower redshift and becomes worse as redshift increases. The lower panel shows
    the scatter plot between uncertainty and SNR in $GI$ band, and we notice that
    with SNR increasing, the scatter of uncertainties becomes smaller with the values
    close to $0$.
  prefs: []
  type: TYPE_NORMAL
- en: For comparison, according to the data analysis pipeline for CSST slitless spectra,
    the traditional fitting for redshift estimations may produce an accuracy as low
    as $\sim 1\%$ under such low-SNR shown in Figure [3](#S2.F3 "Figure 3 ‣ 2.2 Data
    generation ‣ 2 Mock Data ‣ Accurately Estimating Redshifts from CSST Slitless
    Spectroscopic Survey using Deep Learning"). This demonstrates that deep learning
    algorithm can significantly enhance the accuracy of redshift estimation from low-SNR
    slitless spectra.
  prefs: []
  type: TYPE_NORMAL
- en: '![Refer to caption](img/a1d82b5e500181bcc13345ef2a51442e.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 7: The results of 1d-CNN are illustrated, achieving accuracy $\sigma_{\rm
    NMAD}=0.00047$ and outlier percentage $\eta=0.954\%$ respectively. The logarithmic
    SNR of $GI$ bands are indicated by colorbar.'
  prefs: []
  type: TYPE_NORMAL
- en: '![Refer to caption](img/1d375d898713d3f732322ccb61d70327.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 8: The distributions of true and predicted redshifts from CNN and BNN
    for testing data.'
  prefs: []
  type: TYPE_NORMAL
- en: '![Refer to caption](img/59c9ab8afedf6d368cc932c25f900cbc.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 9: The accuracy $\sigma_{\rm NMAD}$ and outlier percentage $\eta$ with
    respect to true redshifts are displayed in the upper and lower panel respectively.
    The two metrics over whole redshift range are also shown in black dashed lines.'
  prefs: []
  type: TYPE_NORMAL
- en: '![Refer to caption](img/0a4a742ce23190a00d4adb73a8dd2f0b.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 10: Reliability diagram for BNN results before and after the calibration.
    The black dashed line indicates that the uncertainties are well-calibrated with
    statistical principle perfectly followed.'
  prefs: []
  type: TYPE_NORMAL
- en: '![Refer to caption](img/f397e98ec390f341b5d6c2241192913c.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 11: The results of BNN after uncertainty calibration. The errorbars
    are displayed in lightblue. Over the whole redshift range, BNN can reach $\sigma_{\rm
    NMAD}=0.00063$ and $\eta=0.92\%$ respectively. And weighted mean uncertainty $\overline{E}$
    can achieve 0.00228.'
  prefs: []
  type: TYPE_NORMAL
- en: '![Refer to caption](img/253f23da10b6761d3298d14d106dd6d4.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 12: Upper: weighted mean uncertainty $\overline{E}$ with respect to
    true redshift. The value over whole redshift range is also displayed in black
    dashed line. Lower: weighted uncertainty $E$ with respect to SNR in $GI$ band.'
  prefs: []
  type: TYPE_NORMAL
- en: 5 Conclusion
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In this work, we employ neural network to estimate the redshift from simulated
    slitless spectra in the CSST slitless spectroscopic survey. The simulation requires
    SED and four morphological parameters including effective radius, sersic index,
    axis ratio and position angle of each galaxy. To simulate the slitless spectra
    realistically, we use observational data from DESI-EDR and BOSS-DR16 with high-quality
    spectroscopic redshifts. The model spectra generated in spectrum fitting process
    for these two observations are considered as SEDs, and the sources are matched
    with DESI LS DR9 to retrieve the required morphological parameters. The SNR of
    the slitless spectra are low with total SNRs peaking at $\sim 1$, hence the key
    spectroscopic features used for redshift determinations are hard to identify.
    Therefore, we leverage the superior capability in processing noisy data of neural
    network to estimate the redshifts from these slitless spectra.
  prefs: []
  type: TYPE_NORMAL
- en: Recognizing the importance of uncertainty predictions for several cosmological
    studies, we employ Bayesian network to accomplish this task by providing redshift
    estimations along with uncertainties. To increase the robustness and converging
    speed, we construct the BNN based on a CNN for point estimates using transfer
    learning techniques. Gaussian random realizations are employed to largely augment
    the training size, ensuring the generative ability and noise tolerance of BNN.
    After training, the uncertainty predictions for testing data are carefully calibrated.
    The BNN can achieve the results of $\sigma_{\rm NMAD}=0.00063$, $\eta=0.92\%$
    and $\overline{E}=0.00228$, successfully satisfying the performance requirement
    of accuracy $\sim 0.2\%$ for cosmological studies based on slitless spectra of
    CSST. Our approach can achieve better performance than traditional SED fitting,
    particularly for low SNR slitless spectra, serving as a complementary method for
    spectroscopic redshift estimation.
  prefs: []
  type: TYPE_NORMAL
- en: However, our analysis is restricted to low redshift $z\lesssim 1$, which can
    be attributed to the limitation of data from DESI-EDR and BOSS-DR16 and relatively
    low resolution of galaxy images from DESI legacy imaging survey. With future data
    release from DESI and higher resolution imaging survey, we anticipate that our
    simulation can reach higher redshift, better following the redshift distribution
    of CSST slitless spectrocscopic survey, hence providing a comprehensive investigation
    of the spectroscopic redshift accuracy that can be achieved by deep learning algorithm.
  prefs: []
  type: TYPE_NORMAL
- en: XCZ and YG acknowledge the support from National Key R&D Program of China grant
    2022YFF0503404, 2020SKA0110402, and the CAS Project for Young Scientists in Basic
    Research (no. YSBR- 092). This work is also supported by science research grants
    from the China Manned Space Project with grant nos. CMS-CSST-2021-B01 and CMS-CSST-2021-A01\.
    HZ acknowledges the science research grants from the China Manned Space Project
    with Nos. CMS-CSST-2021-A02 and CMS-CSST-2021-A04 and the supports from National
    Natural Science Foundation of China (NSFC; grant Nos. 12120101003 and 12373010)
    and National Key R&D Program of China (grant Nos. 2023YFA1607800, 2022YFA1602902)
    and Strategic Priority Research Program of the Chinese Academy of Science (Grant
    Nos. XDB0550100).
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Agarap (2018) Agarap, A. F. 2018, arXiv e-prints, arXiv:1803.08375, doi: [10.48550/arXiv.1803.08375](http://doi.org/10.48550/arXiv.1803.08375)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ahumada et al. (2020) Ahumada, R., Allende Prieto, C., Almeida, A., et al. 2020,
    ApJS, 249, 3, doi: [10.3847/1538-4365/ab929e](http://doi.org/10.3847/1538-4365/ab929e)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Arendt et al. (2024) Arendt, A. R., Perrott, Y. C., Contreras-Santos, A., et al.
    2024, MNRAS, 530, 20, doi: [10.1093/mnras/stae568](http://doi.org/10.1093/mnras/stae568)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Bassett & Hlozek (2010) Bassett, B., & Hlozek, R. 2010, in Dark Energy: Observational
    and Theoretical Approaches, ed. P. Ruiz-Lapuente, 246, doi: [10.48550/arXiv.0910.5224](http://doi.org/10.48550/arXiv.0910.5224)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Blundell et al. (2015) Blundell, C., Cornebise, J., Kavukcuoglu, K., & Wierstra,
    D. 2015, arXiv e-prints, arXiv:1505.05424, doi: [10.48550/arXiv.1505.05424](http://doi.org/10.48550/arXiv.1505.05424)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Busca & Balland (2018) Busca, N., & Balland, C. 2018, arXiv e-prints, arXiv:1808.09955,
    doi: [10.48550/arXiv.1808.09955](http://doi.org/10.48550/arXiv.1808.09955)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Collister & Lahav (2004) Collister, A. A., & Lahav, O. 2004, PASP, 116, 345,
    doi: [10.1086/383254](http://doi.org/10.1086/383254)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Dawson et al. (2013) Dawson, K. S., Schlegel, D. J., Ahn, C. P., et al. 2013,
    AJ, 145, 10, doi: [10.1088/0004-6256/145/1/10](http://doi.org/10.1088/0004-6256/145/1/10)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: DESI Collaboration et al. (2016) DESI Collaboration, Aghamousa, A., Aguilar,
    J., et al. 2016, arXiv e-prints, arXiv:1611.00036, doi: [10.48550/arXiv.1611.00036](http://doi.org/10.48550/arXiv.1611.00036)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: DESI Collaboration et al. (2023) DESI Collaboration, Adame, A. G., Aguilar,
    J., et al. 2023, arXiv e-prints, arXiv:2306.06308, doi: [10.48550/arXiv.2306.06308](http://doi.org/10.48550/arXiv.2306.06308)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Dey et al. (2019) Dey, A., Schlegel, D. J., Lang, D., et al. 2019, AJ, 157,
    168, doi: [10.3847/1538-3881/ab089d](http://doi.org/10.3847/1538-3881/ab089d)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Dinh et al. (2016) Dinh, L., Sohl-Dickstein, J., & Bengio, S. 2016, arXiv e-prints,
    arXiv:1605.08803, doi: [10.48550/arXiv.1605.08803](http://doi.org/10.48550/arXiv.1605.08803)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Euclid Collaboration et al. (2024) Euclid Collaboration, Mellier, Y., Abdurro’uf,
    et al. 2024, arXiv e-prints, arXiv:2405.13491, doi: [10.48550/arXiv.2405.13491](http://doi.org/10.48550/arXiv.2405.13491)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Fluri et al. (2022) Fluri, J., Kacprzak, T., Lucchi, A., et al. 2022, Phys. Rev. D,
    105, 083518, doi: [10.1103/PhysRevD.105.083518](http://doi.org/10.1103/PhysRevD.105.083518)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Gal & Ghahramani (2015) Gal, Y., & Ghahramani, Z. 2015, arXiv e-prints, arXiv:1506.02142,
    doi: [10.48550/arXiv.1506.02142](http://doi.org/10.48550/arXiv.1506.02142)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Gong et al. (2019) Gong, Y., Liu, X., Cao, Y., et al. 2019, ApJ, 883, 203, doi: [10.3847/1538-4357/ab391e](http://doi.org/10.3847/1538-4357/ab391e)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Gupta et al. (2018) Gupta, A., Zorrilla Matilla, J. M., Hsu, D., & Haiman, Z.
    2018, Phys. Rev. D, 97, 103515, doi: [10.1103/PhysRevD.97.103515](http://doi.org/10.1103/PhysRevD.97.103515)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Hamilton (1998) Hamilton, A. J. S. 1998, in Astrophysics and Space Science Library,
    Vol. 231, The Evolving Universe, ed. D. Hamilton, 185, doi: [10.1007/978-94-011-4960-0_17](http://doi.org/10.1007/978-94-011-4960-0_17)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: He et al. (2015) He, K., Zhang, X., Ren, S., & Sun, J. 2015, arXiv e-prints,
    arXiv:1512.03385, doi: [10.48550/arXiv.1512.03385](http://doi.org/10.48550/arXiv.1512.03385)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: He et al. (2020) He, Z., Er, X., Long, Q., et al. 2020, MNRAS, 497, 556, doi: [10.1093/mnras/staa1917](http://doi.org/10.1093/mnras/staa1917)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Henghes et al. (2022) Henghes, B., Thiyagalingam, J., Pettitt, C., Hey, T.,
    & Lahav, O. 2022, MNRAS, 512, 1696, doi: [10.1093/mnras/stac480](http://doi.org/10.1093/mnras/stac480)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Hortúa et al. (2023) Hortúa, H. J., García, L. Á., & Castañeda C., L. 2023,
    Frontiers in Astronomy and Space Sciences, 10, 1139120, doi: [10.3389/fspas.2023.1139120](http://doi.org/10.3389/fspas.2023.1139120)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Hortúa et al. (2020) Hortúa, H. J., Volpi, R., Marinelli, D., & Malagò, L. 2020,
    Phys. Rev. D, 102, 103509, doi: [10.1103/PhysRevD.102.103509](http://doi.org/10.1103/PhysRevD.102.103509)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ioffe & Szegedy (2015) Ioffe, S., & Szegedy, C. 2015, arXiv e-prints, arXiv:1502.03167,
    doi: [10.48550/arXiv.1502.03167](http://doi.org/10.48550/arXiv.1502.03167)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Jimenez Rezende & Mohamed (2015) Jimenez Rezende, D., & Mohamed, S. 2015, arXiv
    e-prints, arXiv:1505.05770, doi: [10.48550/arXiv.1505.05770](http://doi.org/10.48550/arXiv.1505.05770)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Kingma & Ba (2014) Kingma, D. P., & Ba, J. 2014, arXiv e-prints, arXiv:1412.6980,
    doi: [10.48550/arXiv.1412.6980](http://doi.org/10.48550/arXiv.1412.6980)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Kull et al. (2017) Kull, M., Filho, T. S., & Flach, P. 2017, in Proceedings
    of Machine Learning Research, Vol. 54, Proceedings of the 20th International Conference
    on Artificial Intelligence and Statistics, ed. A. Singh & J. Zhu (PMLR), 623–631.
    [https://proceedings.mlr.press/v54/kull17a.html](https://proceedings.mlr.press/v54/kull17a.html)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Le Fevre et al. (2013) Le Fevre, O., Cassata, P., Cucciati, O., et al. 2013,
    arXiv e-prints, arXiv:1307.0545, doi: [10.48550/arXiv.1307.0545](http://doi.org/10.48550/arXiv.1307.0545)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Lecun et al. (1998) Lecun, Y., Bottou, L., Bengio, Y., & Haffner, P. 1998, Proceedings
    of the IEEE, 86, 2278, doi: [10.1109/5.726791](http://doi.org/10.1109/5.726791)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Li et al. (2020) Li, R., Napolitano, N. R., Tortora, C., et al. 2020, ApJ, 899,
    30, doi: [10.3847/1538-4357/ab9dfa](http://doi.org/10.3847/1538-4357/ab9dfa)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Lilly et al. (2007) Lilly, S. J., Le Fevre, O., Renzini, A., Zamorani, G., &
    Scodeggio, M. 2007, ApJS, 172, 70, doi: [10.1086/516589](http://doi.org/10.1086/516589)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Louizos & Welling (2017) Louizos, C., & Welling, M. 2017, arXiv e-prints, arXiv:1703.01961,
    doi: [10.48550/arXiv.1703.01961](http://doi.org/10.48550/arXiv.1703.01961)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'MacKay (1995) MacKay, D. J. C. 1995, Network: Computation in Neural Systems,
    6, 469'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Mainieri et al. (2024) Mainieri, V., Anderson, R. I., Brinchmann, J., et al.
    2024, arXiv e-prints, arXiv:2403.05398, doi: [10.48550/arXiv.2403.05398](http://doi.org/10.48550/arXiv.2403.05398)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Min et al. (2024) Min, Z., Xiao, X., Ding, J., et al. 2024, arXiv e-prints,
    arXiv:2404.09483, doi: [10.48550/arXiv.2404.09483](http://doi.org/10.48550/arXiv.2404.09483)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Pan et al. (2020) Pan, S., Liu, M., Forero-Romero, J., et al. 2020, Science
    China Physics, Mechanics, and Astronomy, 63, 110412, doi: [10.1007/s11433-020-1586-3](http://doi.org/10.1007/s11433-020-1586-3)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Pasquet et al. (2019) Pasquet, J., Bertin, E., Treyer, M., Arnouts, S., & Fouchez,
    D. 2019, A&A, 621, A26, doi: [10.1051/0004-6361/201833617](http://doi.org/10.1051/0004-6361/201833617)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Pearson et al. (2019) Pearson, W. J., Wang, L., Trayford, J. W., Petrillo, C. E.,
    & van der Tak, F. F. S. 2019, A&A, 626, A49, doi: [10.1051/0004-6361/201935355](http://doi.org/10.1051/0004-6361/201935355)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Perreault Levasseur et al. (2017) Perreault Levasseur, L., Hezaveh, Y. D., &
    Wechsler, R. H. 2017, ApJ, 850, L7, doi: [10.3847/2041-8213/aa9704](http://doi.org/10.3847/2041-8213/aa9704)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Rastegarnia et al. (2022) Rastegarnia, F., Mirtorabi, M. T., Moradi, R., Vafaei
    Sadr, A., & Wang, Y. 2022, MNRAS, 511, 4490, doi: [10.1093/mnras/stac076](http://doi.org/10.1093/mnras/stac076)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Rezaei et al. (2022) Rezaei, S., McKean, J. P., Biehl, M., de Roo, W., & Lafontaine,
    A. 2022, MNRAS, 517, 1156, doi: [10.1093/mnras/stac2078](http://doi.org/10.1093/mnras/stac2078)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Sabelhaus & Decker (2004) Sabelhaus, P. A., & Decker, J. E. 2004, in Society
    of Photo-Optical Instrumentation Engineers (SPIE) Conference Series, Vol. 5487,
    Optical, Infrared, and Millimeter Space Telescopes, ed. J. C. Mather, 550–563,
    doi: [10.1117/12.549895](http://doi.org/10.1117/12.549895)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Sadeh (2014) Sadeh, I. 2014, in Statistical Challenges in 21st Century Cosmology,
    ed. A. Heavens, J.-L. Starck, & A. Krone-Martins, Vol. 306, 316–318, doi: [10.1017/S1743921314010849](http://doi.org/10.1017/S1743921314010849)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Schaefer et al. (2018) Schaefer, C., Geiger, M., Kuntzer, T., & Kneib, J. P.
    2018, A&A, 611, A2, doi: [10.1051/0004-6361/201731201](http://doi.org/10.1051/0004-6361/201731201)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Schlegel et al. (2022) Schlegel, D. J., Kollmeier, J. A., Aldering, G., et al.
    2022, arXiv e-prints, arXiv:2209.04322, doi: [10.48550/arXiv.2209.04322](http://doi.org/10.48550/arXiv.2209.04322)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Srivastava et al. (2014) Srivastava, N., Hinton, G., Krizhevsky, A., Sutskever,
    I., & Salakhutdinov, R. 2014, Journal of Machine Learning Research, 15, 1929.
    [http://jmlr.org/papers/v15/srivastava14a.html](http://jmlr.org/papers/v15/srivastava14a.html)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Tamura et al. (2016) Tamura, N., Takato, N., Shimono, A., et al. 2016, in Society
    of Photo-Optical Instrumentation Engineers (SPIE) Conference Series, Vol. 9908,
    Ground-based and Airborne Instrumentation for Astronomy VI, ed. C. J. Evans, L. Simard,
    & H. Takami, 99081M, doi: [10.1117/12.2232103](http://doi.org/10.1117/12.2232103)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Tewes et al. (2019) Tewes, M., Kuntzer, T., Nakajima, R., et al. 2019, A&A,
    621, A36, doi: [10.1051/0004-6361/201833775](http://doi.org/10.1051/0004-6361/201833775)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Wen et al. (2018) Wen, Y., Vicol, P., Ba, J., Tran, D., & Grosse, R. 2018, arXiv
    e-prints, arXiv:1803.04386, doi: [10.48550/arXiv.1803.04386](http://doi.org/10.48550/arXiv.1803.04386)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Zhan (2018) Zhan, H. 2018, in 42nd COSPAR Scientific Assembly, Vol. 42, E1.16–4–18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Zhang et al. (2024) Zhang, Z., Shan, H., Li, N., et al. 2024, A&A, 683, A209,
    doi: [10.1051/0004-6361/202345903](http://doi.org/10.1051/0004-6361/202345903)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Zhou et al. (2022a) Zhou, X., Gong, Y., Meng, X.-M., et al. 2022a, Research
    in Astronomy and Astrophysics, 22, 115017, doi: [10.1088/1674-4527/ac9578](http://doi.org/10.1088/1674-4527/ac9578)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Zhou et al. (2022b) —. 2022b, Research in Astronomy and Astrophysics, 22, 115017,
    doi: [10.1088/1674-4527/ac9578](http://doi.org/10.1088/1674-4527/ac9578)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Zhou et al. (2021) —. 2021, ApJ, 909, 53, doi: [10.3847/1538-4357/abda3e](http://doi.org/10.3847/1538-4357/abda3e)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
